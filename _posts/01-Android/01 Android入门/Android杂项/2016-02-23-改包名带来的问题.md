---
date_created: Friday, February 23rd 2016, 10:10:45 pm
date_updated: Sunday, January 26th 2025, 10:09:56 am
title: 改包名带来的问题
author: hacket
categories:
  - Android
category: Android基础
tags: []
toc: true
description: 
dg-publish: true
dg-enable-search: true
dg-show-local-graph: true
dg-show-toc: true
dg-show-file-tree: true
date created: 星期二, 十二月 24日 2024, 12:26:00 凌晨
date updated: 星期一, 一月 6日 2025, 9:46:48 晚上
image-auto-upload: true
feed: show
format: list
aliases: [改包名带来的问题]
linter-yaml-title-alias: 改包名带来的问题
---

# 改包名带来的问题

## 1、RemoteViews 包名写死了的问题

```java
RemoteViews expandedView = new RemoteViews(
        mContext.getPackageName(),
        task.mControl == Downloads.CONTROL_RUN ? R.layout.status_bar_ongoing_event_progress_bar
                : R.layout.status_bar_download_pause);
```

## 2、微信资源混淆，白名单 xxx.R 要改为 applicationId.R，因为在代码中用到的 package.R 会被动态的替换成 applicationId.R

applicationId 和 package 带来的血案 - 微信资源混淆

- **清单文件：**

> package="com.baidu.browser.inter"

- **build.gradle：**

> applicationId 'com.browser.internet'

- 编译后的 apk，package 被替换成了 `applicationId`
- 引入了微信资源混淆，定义了一堆白名单不混淆的资源，但 R 用的包名还是清单文件中的 package，而在 build.gradle 定义了 applicationId 后，清单文件中的 package 会被动态的替换成 applicationId，R 引用的资源也会被动态的替换成 applicationId.R，导致白名单的一些资源被混淆了，从而导致 crash。

```groovy
andResGuard {
    mappingFile = null
    use7zip = true
    keepRoot = false
    // add <yourpackagename>.R.drawable.icon into whitelist.
    // because the launcher will get the icon with his name
    whiteList = [
            "com.baidu.browser.inter.R.drawable.logo_obt",
            "com.baidu.browser.inter.R.drawable.category_item_*",
            "com.baidu.browser.inter.R.drawable.*zeus*",
            "com.baidu.browser.inter.R.drawable.zeus*",
            "com.baidu.browser.inter.R.drawable.*zeus",
            "com.baidu.browser.inter.R.layout.*zeus*",
            "com.baidu.browser.inter.R.layout.zeus*",
            "com.baidu.browser.inter.R.layout.*zeus",
            "com.baidu.browser.inter.R.raw.*zeus*",
            "com.baidu.browser.inter.R.raw.zeus*",
            "com.baidu.browser.inter.R.raw.*zeus",
            "com.baidu.browser.inter.R.menu.*zeus*",
            "com.baidu.browser.inter.R.menu.zeus*",
            "com.baidu.browser.inter.R.menu.*zeus",
            "com.baidu.browser.inter.R.anim.*zeus*",
            "com.baidu.browser.inter.R.anim.zeus*",
            "com.baidu.browser.inter.R.anim.*zeus",
            "com.baidu.browser.inter.R.color.*zeus*",
            "com.baidu.browser.inter.R.color.zeus*",
            "com.baidu.browser.inter.R.color.*zeus",
            "com.baidu.browser.inter.R.string.*zeus*",
            "com.baidu.browser.inter.R.string.zeus*",
            "com.baidu.browser.inter.R.string.*zeus",
            "com.baidu.browser.inter.R.drawable.logo_news",
            "com.baidu.browser.inter.R.drawable.float_window_option*",
            "com.baidu.browser.inter.R.string.float_win_option*",
            "com.baidu.browser.inter.R.id.*"
    ]
    compressFilePattern = [
            "*.png",
            "*.jpg",
            "*.jpeg",
            "*.gif",
            "resources.arsc"
    ]
}
```

出现的问题：`android.content.res.Resources$NotFoundException`

- 解决：
把微信资源混淆的包名替换成 build.gradle 中的 applicationId 即可。
