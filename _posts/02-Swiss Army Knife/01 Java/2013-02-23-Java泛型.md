---
banner:
date_created: Friday, February 23rd 2013, 10:10:45 pm
date_updated: Wednesday, November 19th 2025, 8:37:36 am
title: Javaæ³›å‹
author: hacket
categories:
  - Java&Kotlin
category: JavaåŸºç¡€
tags: [JavaåŸºç¡€, æ³›å‹]
toc: true
description: 
dg-publish: true
dg-enable-search: true
dg-show-local-graph: true
dg-show-toc: true
dg-show-file-tree: true
image-auto-upload: true
feed: show
format: list
date created: 2024-12-27 23:44
date updated: 2024-12-28 00:21
aliases: [æ³›å‹]
linter-yaml-title-alias: æ³›å‹
---

# æ³›å‹

## åŸºæœ¬æ¦‚å¿µ

ä»€ä¹ˆæ˜¯æ³›å‹ï¼Ÿä¸ºä»€ä¹ˆè¦ä½¿ç”¨æ³›å‹ï¼Ÿ

> **æ³›å‹ï¼Œå³ " å‚æ•°åŒ–ç±»å‹ "ã€‚ä¸€æåˆ°å‚æ•°ï¼Œæœ€ç†Ÿæ‚‰çš„å°±æ˜¯å®šä¹‰æ–¹æ³•æ—¶æœ‰å½¢å‚ï¼Œç„¶åè°ƒç”¨æ­¤æ–¹æ³•æ—¶ä¼ é€’å®å‚ã€‚** é‚£ä¹ˆå‚æ•°åŒ–ç±»å‹æ€ä¹ˆç†è§£å‘¢ï¼Ÿé¡¾åæ€ä¹‰ï¼Œå°±æ˜¯å°†ç±»å‹ç”±åŸæ¥çš„å…·ä½“çš„ç±»å‹å‚æ•°åŒ–ï¼Œç±»ä¼¼äºæ–¹æ³•ä¸­çš„å˜é‡å‚æ•°ï¼Œæ­¤æ—¶ç±»å‹ä¹Ÿå®šä¹‰æˆå‚æ•°å½¢å¼ï¼ˆå¯ä»¥ç§°ä¹‹ä¸ºç±»å‹å½¢å‚ï¼‰ï¼Œç„¶ååœ¨ä½¿ç”¨/è°ƒç”¨æ—¶ä¼ å…¥å…·ä½“çš„ç±»å‹ï¼ˆç±»å‹å®å‚ï¼‰ã€‚
>
> **æ³›å‹çš„æœ¬è´¨æ˜¯ä¸ºäº†å‚æ•°åŒ–ç±»å‹ï¼ˆåœ¨ä¸åˆ›å»ºæ–°çš„ç±»å‹çš„æƒ…å†µä¸‹ï¼Œé€šè¿‡æ³›å‹æŒ‡å®šçš„ä¸åŒç±»å‹æ¥æ§åˆ¶å½¢å‚å…·ä½“é™åˆ¶çš„ç±»å‹ï¼‰ã€‚** ä¹Ÿå°±æ˜¯è¯´åœ¨æ³›å‹ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œæ“ä½œçš„æ•°æ®ç±»å‹è¢«æŒ‡å®šä¸ºä¸€ä¸ªå‚æ•°ï¼Œè¿™ç§å‚æ•°ç±»å‹å¯ä»¥ç”¨åœ¨ç±»ã€æ¥å£å’Œæ–¹æ³•ä¸­ï¼Œåˆ†åˆ«è¢«ç§°ä¸ºæ³›å‹ç±»ã€æ³›å‹æ¥å£ã€æ³›å‹æ–¹æ³•ã€‚

`æ³›å‹`ï¼Œå®ƒçš„æ„æ€æ˜¯æŠŠå…·ä½“çš„ç±»å‹æ³›åŒ–ï¼Œç¼–ç çš„æ—¶å€™ (ç¼–è¯‘å™¨) ç”¨ç¬¦å·æ¥æŒ‡ä»£ç±»å‹ï¼Œåœ¨ä½¿ç”¨çš„æ—¶å€™ï¼ˆè¿è¡Œæ—¶ï¼‰ï¼Œå†ç¡®å®šå®ƒçš„ç±»å‹ã€‚

### æ³›å½¢çš„åŸºæœ¬æœ¯è¯­

ä»¥ ArrayList ä¸ºä¾‹ï¼š`<>` å¿µç€**typeof**

1. ArrayList ä¸­çš„ E ç§°ä¸º `ç±»å‹å‚æ•°å˜é‡`
2. ArrayList ä¸­çš„ Integer ç§°ä¸º `å®é™…ç±»å‹å‚æ•°`
3. æ•´ä¸ªç§°ä¸º ArrayList `æ³›å‹ç±»å‹`
4. æ•´ä¸ª ArrayList ç§°ä¸º `å‚æ•°åŒ–çš„ç±»å‹(ParameterizedType)`

## æ³›å‹åŸºç¡€

æ³›å‹æœ‰ä¸‰ç§ä½¿ç”¨æ–¹å¼ï¼Œåˆ†åˆ«ä¸ºï¼šæ³›å‹ç±»ã€æ³›å‹æ¥å£ã€æ³›å‹æ–¹æ³•

### æ³›å‹ç±»

æ³›å‹ç±»å‹ç”¨äºç±»çš„å®šä¹‰ä¸­ï¼Œè¢«ç§°ä¸ºæ³›å‹ç±»ã€‚é€šè¿‡æ³›å‹å¯ä»¥å®Œæˆå¯¹ä¸€ç»„ç±»çš„æ“ä½œå¯¹å¤–å¼€æ”¾ç›¸åŒçš„æ¥å£ã€‚æœ€å…¸å‹çš„å°±æ˜¯å„ç§å®¹å™¨ç±»ï¼Œå¦‚ï¼šListã€Setã€Mapã€‚(å¦‚æœä¸€ä¸ªç±»å¤šå¤„éƒ½è¦ç”¨åˆ°åŒä¸€ä¸ªæ³›å‹ï¼Œè¿™æ—¶å¯ä»¥æŠŠæ³›å½¢å®šä¹‰åœ¨ç±»ä¸Š (å³ç±»çº§åˆ«çš„æ³›å‹))

> æ³¨æ„ï¼šé™æ€æ–¹æ³•ä¸èƒ½ä½¿ç”¨ç±»å®šä¹‰çš„æ³›å½¢ï¼Œè€Œåº”å•ç‹¬å®šä¹‰æ³›å½¢ã€‚

æ³›å‹ç±»çš„æœ€åŸºæœ¬å†™æ³•:

```java
class ç±»åç§° <æ³›å‹æ ‡è¯†ï¼šå¯ä»¥éšä¾¿å†™ä»»æ„æ ‡è¯†å·ï¼Œæ ‡è¯†æŒ‡å®šçš„æ³›å‹çš„ç±»å‹>{
  private æ³›å‹æ ‡è¯† /*ï¼ˆæˆå‘˜å˜é‡ç±»å‹ï¼‰*/ var; 
    // .....
  }
}
```

ä¸€ä¸ªæœ€æ™®é€šçš„æ³›å‹ç±»ï¼š

```java
//æ­¤å¤„Tå¯ä»¥éšä¾¿å†™ä¸ºä»»æ„æ ‡è¯†ï¼Œå¸¸è§çš„å¦‚Tã€Eã€Kã€Vç­‰å½¢å¼çš„å‚æ•°å¸¸ç”¨äºè¡¨ç¤ºæ³›å‹
//åœ¨å®ä¾‹åŒ–æ³›å‹ç±»æ—¶ï¼Œå¿…é¡»æŒ‡å®šTçš„å…·ä½“ç±»å‹
public class Generic<T>{ 
    //keyè¿™ä¸ªæˆå‘˜å˜é‡çš„ç±»å‹ä¸ºT,Tçš„ç±»å‹ç”±å¤–éƒ¨æŒ‡å®š  
    private T key;

    public Generic(T key) { //æ³›å‹æ„é€ æ–¹æ³•å½¢å‚keyçš„ç±»å‹ä¹Ÿä¸ºTï¼ŒTçš„ç±»å‹ç”±å¤–éƒ¨æŒ‡å®š
        this.key = key;
    }

    public T getKey(){ //æ³›å‹æ–¹æ³•getKeyçš„è¿”å›å€¼ç±»å‹ä¸ºTï¼ŒTçš„ç±»å‹ç”±å¤–éƒ¨æŒ‡å®š
        return key;
    }
}
```

1. æ³›å‹çš„ç±»å‹å‚æ•°åªèƒ½æ˜¯ç±»ç±»å‹ï¼Œä¸èƒ½æ˜¯ç®€å•ç±»å‹ã€‚
2. ä¸èƒ½å¯¹ç¡®åˆ‡çš„æ³›å‹ç±»å‹ä½¿ç”¨ instanceof æ“ä½œã€‚å¦‚ä¸‹é¢çš„æ“ä½œæ˜¯éæ³•çš„ï¼Œç¼–è¯‘æ—¶ä¼šå‡ºé”™ã€‚

```java
if(ex_num instanceof Generic<Number>) {   
}
```

### æ³›å‹æ¥å£

æ³›å‹æ¥å£ä¸æ³›å‹ç±»çš„å®šä¹‰åŠä½¿ç”¨åŸºæœ¬ç›¸åŒã€‚æ³›å‹æ¥å£å¸¸è¢«ç”¨åœ¨å„ç§ç±»çš„ç”Ÿäº§å™¨ä¸­ï¼Œå¯ä»¥çœ‹ä¸€ä¸ªä¾‹å­ï¼š

```java
//å®šä¹‰ä¸€ä¸ªæ³›å‹æ¥å£
public interface Generator<T> {
    public T next();
}
```

å½“å®ç°æ³›å‹æ¥å£çš„ç±»ï¼Œæœªä¼ å…¥æ³›å‹å®å‚æ—¶ï¼š

```java
/**
 * æœªä¼ å…¥æ³›å‹å®å‚æ—¶ï¼Œä¸æ³›å‹ç±»çš„å®šä¹‰ç›¸åŒï¼Œåœ¨å£°æ˜ç±»çš„æ—¶å€™ï¼Œéœ€å°†æ³›å‹çš„å£°æ˜ä¹Ÿä¸€èµ·åŠ åˆ°ç±»ä¸­
 * å³ï¼šclass FruitGenerator<T> implements Generator<T>{
 * å¦‚æœä¸å£°æ˜æ³›å‹ï¼Œå¦‚ï¼šclass FruitGenerator implements Generator<T>ï¼Œç¼–è¯‘å™¨ä¼šæŠ¥é”™ï¼š"Unknown class"
 */
class FruitGenerator<T> implements Generator<T>{
    @Override
    public T next() {
        return null;
    }
}
```

å½“å®ç°æ³›å‹æ¥å£çš„ç±»ï¼Œä¼ å…¥æ³›å‹å®å‚æ—¶ï¼š

```java
/**
 * ä¼ å…¥æ³›å‹å®å‚æ—¶ï¼š
 * å®šä¹‰ä¸€ä¸ªç”Ÿäº§å™¨å®ç°è¿™ä¸ªæ¥å£,è™½ç„¶æˆ‘ä»¬åªåˆ›å»ºäº†ä¸€ä¸ªæ³›å‹æ¥å£Generator<T>
 * ä½†æ˜¯æˆ‘ä»¬å¯ä»¥ä¸ºTä¼ å…¥æ— æ•°ä¸ªå®å‚ï¼Œå½¢æˆæ— æ•°ç§ç±»å‹çš„Generatoræ¥å£ã€‚
 * åœ¨å®ç°ç±»å®ç°æ³›å‹æ¥å£æ—¶ï¼Œå¦‚å·²å°†æ³›å‹ç±»å‹ä¼ å…¥å®å‚ç±»å‹ï¼Œåˆ™æ‰€æœ‰ä½¿ç”¨æ³›å‹çš„åœ°æ–¹éƒ½è¦æ›¿æ¢æˆä¼ å…¥çš„å®å‚ç±»å‹
 * å³ï¼šGenerator<T>ï¼Œpublic T next();ä¸­çš„çš„Téƒ½è¦æ›¿æ¢æˆä¼ å…¥çš„Stringç±»å‹ã€‚
 */
public class FruitGenerator implements Generator<String> {

    private String[] fruits = new String[]{"Apple", "Banana", "Pear"};

    @Override
    public String next() {
        Random rand = new Random();
        return fruits[rand.nextInt(3)];
    }
}
```

### æ³›å‹æ–¹æ³•

æ³›å‹ç±»ï¼Œæ˜¯åœ¨å®ä¾‹åŒ–ç±»çš„æ—¶å€™æŒ‡æ˜æ³›å‹çš„å…·ä½“ç±»å‹ï¼›æ³›å‹æ–¹æ³•ï¼Œæ˜¯åœ¨è°ƒç”¨æ–¹æ³•çš„æ—¶å€™æŒ‡æ˜æ³›å‹çš„å…·ä½“ç±»å‹ ã€‚

Java ç¨‹åºä¸­çš„ `æ™®é€šæ–¹` æ³•ã€`æ„é€ æ–¹æ³•` å’Œ `é™æ€æ–¹æ³•` ä¸­éƒ½å¯ä»¥ä½¿ç”¨æ³›å‹ã€‚<br>æ–¹æ³•ä½¿ç”¨æ³›å½¢å‰ï¼Œå¿…é¡»å¯¹æ³›å½¢è¿›è¡Œå£°æ˜ï¼Œ

åœ¨è°ƒç”¨æ³›å‹æ–¹æ³•çš„æ—¶å€™ï¼Œå¯ä»¥æŒ‡å®šæ³›å‹ï¼Œä¹Ÿå¯ä»¥ä¸æŒ‡å®šæ³›å‹ã€‚

1. åœ¨ä¸æŒ‡å®šæ³›å‹çš„æƒ…å†µä¸‹ï¼Œæ³›å‹å˜é‡çš„ç±»å‹ä¸º è¯¥æ–¹æ³•ä¸­çš„å‡ ç§ç±»å‹çš„åŒä¸€ä¸ªçˆ¶ç±»çš„æœ€å°çº§ï¼Œç›´åˆ° Objectã€‚
2. åœ¨æŒ‡å®šæ³›å‹çš„æ—¶å€™ï¼Œè¯¥æ–¹æ³•ä¸­çš„å‡ ç§ç±»å‹å¿…é¡»æ˜¯è¯¥æ³›å‹å®ä¾‹ç±»å‹æˆ–è€…å…¶å­ç±»ã€‚

```java
/*ä¸æŒ‡å®šæ³›å‹çš„æ—¶å€™*/
Integer add = add(1, 3);
Number add1 = add(2.4, 3);
int i = add(1, 2); //è¿™ä¸¤ä¸ªå‚æ•°éƒ½æ˜¯Integerï¼Œæ‰€ä»¥Tä¸ºIntegerç±»å‹
Number f = add(1, 1.2F);//è¿™ä¸¤ä¸ªå‚æ•°ä¸€ä¸ªæ˜¯Integerï¼Œä»¥é£æ ¼æ˜¯Floatï¼Œæ‰€ä»¥å–åŒä¸€çˆ¶ç±»çš„æœ€å°çº§ï¼Œä¸ºNumber
Object o = add(1, "asd");//è¿™ä¸¤ä¸ªå‚æ•°ä¸€ä¸ªæ˜¯Integerï¼Œä»¥é£æ ¼æ˜¯Floatï¼Œæ‰€ä»¥å–åŒä¸€çˆ¶ç±»çš„æœ€å°çº§ï¼Œä¸ºObject

/*æŒ‡å®šæ³›å‹çš„æ—¶å€™*/
int a = æ³›å‹æ“¦é™¤.<Integer>add(1, 2);//æŒ‡å®šäº†Integerï¼Œæ‰€ä»¥åªèƒ½ä¸ºIntegerç±»å‹æˆ–è€…å…¶å­ç±»
int b = æ³›å‹æ“¦é™¤.<Integer>add(1, 2.2F);//ç¼–è¯‘é”™è¯¯ï¼ŒæŒ‡å®šäº†Integerï¼Œä¸èƒ½ä¸ºFloat
Number c = æ³›å‹æ“¦é™¤.<Number>add(1, 2.2); //æŒ‡å®šä¸ºNumberï¼Œæ‰€ä»¥å¯ä»¥ä¸ºIntegerå’ŒFloa

// è¿™æ˜¯ä¸€ä¸ªç®€å•çš„æ³›å‹æ–¹æ³•
public static <T> T add(T x, T y) {
    return y;
}
```

### æ³›å‹æ•°ç»„

åœ¨ Java ä¸­æ˜¯ " ä¸èƒ½åˆ›å»ºä¸€ä¸ªç¡®åˆ‡çš„æ³›å‹ç±»å‹çš„æ•°ç»„ " çš„ã€‚

ä¸‹é¢çš„è¿™ä¸ªä¾‹å­æ˜¯ä¸å¯ä»¥çš„ï¼š

```java
 List<String>[] ls = new ArrayList<String>[10];// ç¼–è¯‘å‡ºé”™
```

è€Œä½¿ç”¨é€šé…ç¬¦åˆ›å»ºæ³›å‹æ•°ç»„æ˜¯å¯ä»¥çš„ï¼Œå¦‚ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼š

```java
List<?>[] ls = new ArrayList<?>[10];  

List<String>[] ls3 = new ArrayList[10]; // ç¼–è¯‘è­¦å‘Šï¼šUncheck assignment
```

## æ³›å‹ç‰¹æ€§

### æ³›å‹ä¸å¤šæ€

```java
TextView textView = new Button(context);
// ğŸ‘† 1. è¿™æ˜¯å¤šæ€ã€‚

List<Button> buttons = new ArrayList<Button>();
List<TextView> textViews = buttons;
// ğŸ‘† 2. å¤šæ€ç”¨åœ¨è¿™é‡Œä¼šæŠ¥é”™ incompatible types: List<Button> cannot be converted to List<TextView>
```

1. Button æ˜¯ç»§æ‰¿è‡ª TextView çš„ï¼Œæ ¹æ® Java å¤šæ€çš„ç‰¹æ€§ï¼Œç¬¬ä¸€å¤„èµ‹å€¼æ˜¯æ­£ç¡®çš„ã€‚
2. ä½†æ˜¯åˆ°äº† List çš„æ—¶å€™ IDE å°±æŠ¥é”™äº†ï¼Œè¿™æ˜¯å› ä¸º Java çš„æ³›å‹æœ¬èº«å…·æœ‰ã€Œä¸å¯å˜æ€§ Invarianceã€ï¼ŒJava é‡Œé¢è®¤ä¸º List å’Œ List ç±»å‹å¹¶ä¸ä¸€è‡´ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå­ç±»çš„æ³›å‹ï¼ˆListï¼‰ä¸å±äºæ³›å‹ï¼ˆListï¼‰çš„å­ç±»ã€‚

> æ³›å‹ä¸æ”¯æŒå¤šæ€ï¼›Java çš„æ³›å‹ç±»å‹ä¼šåœ¨ç¼–è¯‘æ—¶å‘ç”Ÿç±»å‹æ“¦é™¤ï¼Œä¸ºäº†ä¿è¯ç±»å‹å®‰å…¨ï¼Œä¸å…è®¸è¿™æ ·èµ‹å€¼ã€‚

åœ¨ Java é‡Œç”¨æ•°ç»„åšç±»ä¼¼çš„äº‹æƒ…ï¼Œæ˜¯ä¸ä¼šæŠ¥é”™çš„ï¼Œè¿™æ˜¯å› ä¸ºæ•°ç»„å¹¶æ²¡æœ‰åœ¨ç¼–è¯‘æ—¶æ“¦é™¤ç±»å‹ï¼š

```java
TextView[] textViews = new TextView[10];
```

> ä½†æ˜¯åœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œæˆ‘ä»¬çš„ç¡®ä¼šæœ‰è¿™ç§ç±»ä¼¼çš„éœ€æ±‚ï¼Œéœ€è¦å®ç°ä¸Šé¢è¿™ç§èµ‹å€¼ã€‚ava æä¾›äº†ã€Œæ³›å‹é€šé…ç¬¦ã€ `? extends` å’Œ `? super` æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚

### æ³›å‹æ“¦é™¤

Java çš„æ³›å‹æ˜¯ä¼ªæ³›å‹ï¼Œå› ä¸ºï¼Œåœ¨ç¼–è¯‘æœŸé—´ï¼Œæ‰€æœ‰çš„æ³›å‹ä¿¡æ¯éƒ½ä¼šè¢«æ“¦é™¤æ‰ï¼ˆ`ç±»å‹æ“¦é™¤ï¼ˆtype erasureï¼‰`ï¼‰ã€‚<br>Java ä¸­çš„æ³›å‹åŸºæœ¬ä¸Šéƒ½æ˜¯åœ¨ç¼–è¯‘å™¨è¿™ä¸ªå±‚æ¬¡æ¥å®ç°çš„ã€‚åœ¨ç”Ÿæˆçš„ Java å­—èŠ‚ç ä¸­æ˜¯ä¸åŒ…å«æ³›å‹ä¸­çš„ç±»å‹ä¿¡æ¯çš„ã€‚ä½¿ç”¨æ³›å‹çš„æ—¶å€™åŠ ä¸Šçš„ç±»å‹å‚æ•°ï¼Œä¼šåœ¨ç¼–è¯‘å™¨åœ¨ç¼–è¯‘çš„æ—¶å€™å»æ‰ã€‚è¿™ä¸ªè¿‡ç¨‹å°±ç§°ä¸ºç±»å‹æ“¦é™¤ã€‚

å…·ä½“è§ `æ³›å‹æ“¦é™¤.md` ç« èŠ‚

## æ³›å‹é€šé…ç¬¦

è§ `[PECS]æ³›å‹ä¸­çš„é€šé…ç¬¦super Tå’Œextend TåŒºåˆ«(åå˜ã€é€†å˜).md` ç« èŠ‚

### ? æ— é™å®šçš„é€šé…ç¬¦

ç›¸å½“äº `? extends Object`ï¼Œè¡¨ç¤ºå¯¹ç±»å‹æ²¡æœ‰ä»€ä¹ˆé™åˆ¶ï¼Œå¯ä»¥æŠŠï¼Ÿçœ‹æˆæ‰€æœ‰ç±»å‹çš„çˆ¶ç±»

```java
ArrayList<T> al=new ArrayList<T>(); æŒ‡å®šé›†åˆå…ƒç´ åªèƒ½æ˜¯Tç±»å‹
ArrayList<?> al=new ArrayList<?>();é›†åˆå…ƒç´ å¯ä»¥æ˜¯ä»»æ„ç±»å‹
```

### ? extend ä¸Šç•Œï¼Œåå˜

ä¸Šç•Œï¼›åå˜ï¼›`? extend T` åªèƒ½ getï¼Œåªèƒ½å‘å¤–æä¾›æ•°æ®ï¼Œç›¸å¯¹äºå¤–ç•Œæ¥è¯´æ˜¯ä½œä¸ºç”Ÿäº§è€…ï¼ˆProducer extendsï¼‰

### ? super ä¸‹ç•Œï¼Œé€†å˜

ä¸‹ç•Œï¼›é€†å˜ï¼›`? super T` åªèƒ½ addï¼Œåªèƒ½ä»å¤–ç•Œè·å–æ•°æ®ï¼Œç›¸å¯¹äºå¤–ç•Œæ¥è¯´æ˜¯ä½œä¸ºæ¶ˆè´¹è€…ï¼ˆConsumer superï¼‰

## åå°„è·å–æ³›å‹çœŸå®ç±»å‹

å½“æˆ‘ä»¬å¯¹ä¸€ä¸ªæ³›å‹ç±»è¿›è¡Œåå°„æ—¶ï¼Œéœ€è¦çš„åˆ°æ³›å‹ä¸­çš„çœŸå®æ•°æ®ç±»å‹ï¼Œæ¥å®Œæˆå¦‚ json ååºåˆ—åŒ–çš„æ“ä½œã€‚æ­¤æ—¶éœ€è¦é€š<br>è¿‡ Type ä½“ç³»æ¥å®Œæˆã€‚Type æ¥å£åŒ…å«äº†ä¸€ä¸ªå®ç°ç±» (Class) å’Œå››ä¸ªå®ç°æ¥å£ï¼Œä»–ä»¬åˆ†åˆ«æ˜¯ï¼š

1. TypeVariable æ³›å‹ç±»å‹å˜é‡ï¼Œå¯ä»¥æ³›å‹ä¸Šä¸‹é™ç­‰ä¿¡æ¯ï¼›
2. ParameterizedType å…·ä½“çš„æ³›å‹ç±»å‹ï¼Œå¯ä»¥è·å¾—å…ƒæ•°æ®ä¸­æ³›å‹ç­¾åç±»å‹ (æ³›å‹çœŸå®ç±»å‹)
3. GenericArrayType å½“éœ€è¦æè¿°çš„ç±»å‹æ˜¯æ³›å‹ç±»çš„æ•°ç»„æ—¶ï¼Œæ¯”å¦‚ List[],Map[]ï¼Œæ­¤æ¥å£ä¼šä½œä¸º Type çš„å®ç°ã€‚
4. WildcardType Â é€šé…ç¬¦æ³›å‹ï¼Œè·å¾—ä¸Šä¸‹é™ä¿¡æ¯

### TypeVariable

```java
public class TestType <K extends Comparable & Serializable, V> {
    K key;
    V value;
    public static void main(String[] args) throws Exception {
            // è·å–å­—æ®µçš„ç±»å‹
            Field fk = TestType.class.getDeclaredField("key");
            Field fv = TestType.class.getDeclaredField("value");
            TypeVariable keyType = (TypeVariable)fk.getGenericType();
            TypeVariable valueType = (TypeVariable)fv.getGenericType();
            // getName æ–¹æ³•
            System.out.println(keyType.getName()); // K
            System.out.println(valueType.getName()); // V
            // getGenericDeclaration æ–¹æ³•
            System.out.println(keyType.getGenericDeclaration()); // class com.test.TestType
            System.out.println(valueType.getGenericDeclaration()); // class com.test.TestType
            // getBounds æ–¹æ³•
            System.out.println("K çš„ä¸Šç•Œ:"); // æœ‰ä¸¤ä¸ª
            for (Type type : keyType.getBounds()) { // interface java.lang.Comparable
            System.out.println(type); // interface java.io.Serializable
            }
            System.out.println("V çš„ä¸Šç•Œ:"); // æ²¡æ˜ç¡®å£°æ˜ä¸Šç•Œçš„, é»˜è®¤ä¸Šç•Œæ˜¯ Object
            for (Type type : valueType.getBounds()) { // class java.lang.Object
            System.out.println(type);
        }
    }
}
```

### ParameterizedType

```java
public class TestType {
    Map<String, String> map;
    public static void main(String[] args) throws Exception {
        Field f = TestType.class.getDeclaredField("map");
        System.out.println(f.getGenericType()); // java.util.Map<java.lang.String, java.lang.String>
        ParameterizedType pType = (ParameterizedType) f.getGenericType();
        System.out.println(pType.getRawType()); // interface java.util.Map
        for (Type type : pType.getActualTypeArguments()) {
            System.out.println(type); // æ‰“å°ä¸¤é: class java.lang.String
        }
    }
}
```

### GenericArrayType

```java
public class TestType<T> {
    List<String>[] lists;
    public static void main(String[] args) throws Exception {
        Field f = TestType.class.getDeclaredField("lists");
        GenericArrayType genericType = (GenericArrayType) f.getGenericType();
        System.out.println(genericType.getGenericComponentType());
    }
}
```

### WildcardType

```java
public class TestType {
    private List<? extends Number> a; // ä¸Šé™
    private List<? super String> b; //ä¸‹é™
    public static void main(String[] args) throws Exception {
        Field fieldA = TestType.class.getDeclaredField("a");
        Field fieldB = TestType.class.getDeclaredField("b");
        // å…ˆæ‹¿åˆ°èŒƒå‹ç±»å‹
        ParameterizedType pTypeA = (ParameterizedType) fieldA.getGenericType();
        ParameterizedType pTypeB = (ParameterizedType) fieldB.getGenericType();
        // å†ä»èŒƒå‹é‡Œæ‹¿åˆ°é€šé…ç¬¦ç±»å‹
        WildcardType wTypeA = (WildcardType) pTypeA.getActualTypeArguments()[0];
        WildcardType wTypeB = (WildcardType) pTypeB.getActualTypeArguments()[0];
        // æ–¹æ³•æµ‹è¯•
        System.out.println(wTypeA.getUpperBounds()[0]); // class java.lang.Number
        System.out.println(wTypeB.getLowerBounds()[0]); // class java.lang.String
        // çœ‹çœ‹é€šé…ç¬¦ç±»å‹åˆ°åº•æ˜¯ä»€ä¹ˆ, æ‰“å°ç»“æœä¸º: ? extends java.lang.Number
        Gsonååºåˆ—åŒ–
        System.out.println(wTypeA);
    }
}
```

### Gson ååºåˆ—åŒ–

```java
static class Response<T> {
    T data;
    int code;
    String message;

    @Override
    public String toString() {
        return "Response{" +
                "data=" + data +
                ", code=" + code +
                ", message='" + message + '\'' +
                '}';
    }

    public Response(T data, int code, String message) {
        this.data = data;
        this.code = code;
        this.message = message;
    }
}

static class Data {
    String result;

    public Data(String result) {
        this.result = result;
    }

    @Override
    public String toString() {
        return "Data{" +
                "result=" + result +
                '}';
    }
}

public class Test {

    public static void main(String[] args) {
        Response<Data> dataResponse = new Response(new Data("æ•°æ®"), 1, "æˆåŠŸ");
        Gson gson = new Gson();
        String json = gson.toJson(dataResponse);
        System.out.println(json);
        //ä¸ºä»€ä¹ˆTypeTokenè¦å®šä¹‰ä¸ºæŠ½è±¡ç±»ï¼Ÿ
        Response<Data> resp = gson.fromJson(json, new TypeToken<Response<Data>>() {
        }.getType());
        System.out.println(resp.data.result);
    }
}
```

åœ¨è¿›è¡Œ GSON ååºåˆ—åŒ–æ—¶ï¼Œå­˜åœ¨æ³›å‹æ—¶ï¼Œå¯ä»¥å€ŸåŠ© TypeToken è·å– Type ä»¥å®Œæˆæ³›å‹çš„ååºåˆ—åŒ–ã€‚<br>ä½†æ˜¯ä¸ºä»€ä¹ˆ TypeToken è¦è¢«å®šä¹‰ä¸ºæŠ½è±¡ç±»å‘¢ï¼Ÿ

> å› ä¸ºåªæœ‰å®šä¹‰ä¸ºæŠ½è±¡ç±»æˆ–è€…æ¥å£ï¼Œè¿™æ ·åœ¨ä½¿ç”¨æ—¶ï¼Œéœ€è¦åˆ›å»ºå¯¹åº”çš„å®ç°ç±»ï¼Œæ­¤æ—¶ç¡®å®šæ³›å‹ç±»å‹ï¼Œç¼–è¯‘æ‰èƒ½å¤Ÿå°†æ³›å‹<br>signature ä¿¡æ¯è®°å½•åˆ° Class å…ƒæ•°æ®ä¸­ã€‚

## è™šæ‹Ÿæœºæ˜¯å¦‚ä½•å®ç°æ³›å‹çš„ï¼Ÿ

æ³›å‹æ€æƒ³æ—©åœ¨ C++ è¯­è¨€çš„æ¨¡æ¿ï¼ˆTemplateï¼‰ä¸­å°±å¼€å§‹ç”Ÿæ ¹å‘èŠ½ï¼Œåœ¨ Java è¯­è¨€å¤„äºè¿˜æ²¡æœ‰å‡ºç°æ³›å‹çš„ç‰ˆæœ¬æ—¶ï¼Œåªèƒ½é€šè¿‡ Object æ˜¯æ‰€æœ‰ç±»å‹çš„çˆ¶ç±»å’Œç±»å‹å¼ºåˆ¶è½¬æ¢ä¸¤ä¸ªç‰¹ç‚¹çš„é…åˆæ¥å®ç°ç±»å‹æ³›åŒ–ã€‚ï¼Œç”±äº Java è¯­è¨€é‡Œé¢æ‰€æœ‰çš„ç±»å‹éƒ½ç»§æ‰¿äº java.lang.Objectï¼Œæ‰€ä»¥ Object è½¬å‹æˆä»»ä½•å¯¹è±¡éƒ½æ˜¯æœ‰å¯èƒ½çš„ã€‚ä½†æ˜¯ä¹Ÿå› ä¸ºæœ‰æ— é™çš„å¯èƒ½æ€§ï¼Œå°±åªæœ‰ç¨‹åºå‘˜å’Œè¿è¡ŒæœŸçš„è™šæ‹Ÿæœºæ‰çŸ¥é“è¿™ä¸ª Object åˆ°åº•æ˜¯ä¸ªä»€ä¹ˆç±»å‹çš„å¯¹è±¡ã€‚åœ¨ç¼–è¯‘æœŸé—´ï¼Œç¼–è¯‘å™¨æ— æ³•æ£€æŸ¥è¿™ä¸ª Object çš„å¼ºåˆ¶è½¬å‹æ˜¯å¦æˆåŠŸï¼Œå¦‚æœä»…ä»…ä¾èµ–ç¨‹åºå‘˜å»ä¿éšœè¿™é¡¹æ“ä½œçš„æ­£ç¡®æ€§ï¼Œè®¸å¤š ClassCastException çš„é£é™©å°±ä¼šè½¬å«åˆ°ç¨‹åºè¿è¡ŒæœŸä¹‹ä¸­ã€‚

æ³›å‹æŠ€æœ¯åœ¨ C#å’Œ Java ä¹‹ä¸­çš„ä½¿ç”¨æ–¹å¼çœ‹ä¼¼ç›¸åŒï¼Œä½†å®ç°ä¸Šå´æœ‰ç€æ ¹æœ¬æ€§çš„åˆ†æ­§ï¼ŒC#é‡Œé¢æ³›å‹æ— è®ºåœ¨ç¨‹åºæºç ä¸­ã€ç¼–è¯‘åçš„ IL ä¸­ï¼ˆIntermediate Languageï¼Œä¸­é—´è¯­è¨€ï¼Œè¿™æ—¶å€™æ³›å‹æ˜¯ä¸€ä¸ªå ä½ç¬¦ï¼‰ï¼Œæˆ–æ˜¯è¿è¡ŒæœŸçš„ CLR ä¸­ï¼Œéƒ½æ˜¯åˆ‡å®å­˜åœ¨çš„ï¼ŒListï¼œintï¼ä¸ Listï¼œStringï¼å°±æ˜¯ä¸¤ä¸ªä¸åŒçš„ç±»å‹ï¼Œå®ƒä»¬åœ¨ç³»ç»Ÿè¿è¡ŒæœŸç”Ÿæˆï¼Œæœ‰è‡ªå·±çš„è™šæ–¹æ³•è¡¨å’Œç±»å‹æ•°æ®ï¼Œè¿™ç§å®ç°ç§°ä¸ºç±»å‹è†¨èƒ€ï¼ŒåŸºäºè¿™ç§æ–¹æ³•å®ç°çš„æ³›å‹ç§°ä¸ºçœŸå®æ³›å‹ã€‚

Java è¯­è¨€ä¸­çš„æ³›å‹åˆ™ä¸ä¸€æ ·ï¼Œå®ƒåªåœ¨ç¨‹åºæºç ä¸­å­˜åœ¨ï¼Œåœ¨ç¼–è¯‘åçš„å­—èŠ‚ç æ–‡ä»¶ä¸­ï¼Œå°±å·²ç»æ›¿æ¢ä¸ºåŸæ¥çš„åŸç”Ÿç±»å‹ï¼ˆRaw Typeï¼Œä¹Ÿç§°ä¸ºè£¸ç±»å‹ï¼‰äº†ï¼Œå¹¶ä¸”åœ¨ç›¸åº”çš„åœ°æ–¹æ’å…¥äº†å¼ºåˆ¶è½¬å‹ä»£ç ï¼Œå› æ­¤ï¼Œå¯¹äºè¿è¡ŒæœŸçš„ Java è¯­è¨€æ¥è¯´ï¼ŒArrayListï¼œintï¼ä¸ ArrayListï¼œStringï¼å°±æ˜¯åŒä¸€ä¸ªç±»ï¼Œæ‰€ä»¥æ³›å‹æŠ€æœ¯å®é™…ä¸Šæ˜¯ Java è¯­è¨€çš„ä¸€é¢—è¯­æ³•ç³–ï¼ŒJava è¯­è¨€ä¸­çš„æ³›å‹å®ç°æ–¹æ³•ç§°ä¸ºç±»å‹æ“¦é™¤ï¼ŒåŸºäºè¿™ç§æ–¹æ³•å®ç°çš„æ³›å‹ç§°ä¸ºä¼ªæ³›å‹ã€‚

ç”±äº Java æ³›å‹çš„å¼•å…¥ï¼Œå„ç§åœºæ™¯ï¼ˆè™šæ‹Ÿæœºè§£æã€åå°„ç­‰ï¼‰ä¸‹çš„æ–¹æ³•è°ƒç”¨éƒ½å¯èƒ½å¯¹åŸæœ‰çš„åŸºç¡€äº§ç”Ÿå½±å“å’Œæ–°çš„éœ€æ±‚ï¼Œå¦‚åœ¨æ³›å‹ç±»ä¸­å¦‚ä½•è·å–ä¼ å…¥çš„å‚æ•°åŒ–ç±»å‹ç­‰ã€‚å› æ­¤ï¼ŒJCP ç»„ç»‡å¯¹è™šæ‹Ÿæœºè§„èŒƒåšå‡ºäº†ç›¸åº”çš„ä¿®æ”¹ï¼Œå¼•å…¥äº†è¯¸å¦‚ Signatureã€LocalVariableTypeTable ç­‰æ–°çš„å±æ€§ç”¨äºè§£å†³ä¼´éšæ³›å‹è€Œæ¥çš„å‚æ•°ç±»å‹çš„è¯†åˆ«é—®é¢˜ï¼ŒSignature æ˜¯å…¶ä¸­æœ€é‡è¦çš„ä¸€é¡¹å±æ€§ï¼Œå®ƒçš„ä½œç”¨å°±æ˜¯å­˜å‚¨ä¸€ä¸ªæ–¹æ³•åœ¨å­—èŠ‚ç å±‚é¢çš„ç‰¹å¾ç­¾å [3]ï¼Œè¿™ä¸ªå±æ€§ä¸­ä¿å­˜çš„å‚æ•°ç±»å‹å¹¶ä¸æ˜¯åŸç”Ÿç±»å‹ï¼Œè€Œæ˜¯åŒ…æ‹¬äº†å‚æ•°åŒ–ç±»å‹çš„ä¿¡æ¯ã€‚ä¿®æ”¹åçš„è™šæ‹Ÿæœºè§„èŒƒè¦æ±‚æ‰€æœ‰èƒ½è¯†åˆ« 49.0 ä»¥ä¸Šç‰ˆæœ¬çš„ Class æ–‡ä»¶çš„è™šæ‹Ÿæœºéƒ½è¦èƒ½æ­£ç¡®åœ°è¯†åˆ« Signature å‚æ•°ã€‚<br>å¦å¤–ï¼Œä» Signature å±æ€§çš„å‡ºç°æˆ‘ä»¬è¿˜å¯ä»¥å¾—å‡ºç»“è®ºï¼Œæ“¦é™¤æ³•æ‰€è°“çš„æ“¦é™¤ï¼Œä»…ä»…æ˜¯å¯¹æ–¹æ³•çš„ Code å±æ€§ä¸­çš„å­—èŠ‚ç è¿›è¡Œæ“¦é™¤ï¼Œå®é™…ä¸Šå…ƒæ•°æ®ä¸­è¿˜æ˜¯ä¿ç•™äº†æ³›å‹ä¿¡æ¯ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘ä»¬èƒ½é€šè¿‡åå°„æ‰‹æ®µå–å¾—å‚æ•°åŒ–ç±»å‹çš„æ ¹æœ¬ä¾æ®ã€‚

# æ³›å‹æ“¦é™¤ä»‹ç»

Java çš„æ³›å‹æ˜¯ä¼ªæ³›å‹ï¼Œå› ä¸ºï¼Œåœ¨ç¼–è¯‘æœŸé—´ï¼Œæ‰€æœ‰çš„æ³›å‹ä¿¡æ¯éƒ½ä¼šè¢«æ“¦é™¤æ‰ï¼ˆ`ç±»å‹æ“¦é™¤ï¼ˆtype erasureï¼‰`ï¼‰ã€‚

1. æ³›å‹ä¿¡æ¯åªå­˜åœ¨ä»£ç ç¼–è¯‘é˜¶æ®µï¼Œåœ¨è¿›â¼Š JVM ä¹‹å‰ï¼Œä¸æ³›å‹å…³çš„ä¿¡æ¯éƒ½ä¼šè¢«æ“¦é™¤æ‰
2. åœ¨ç±»å‹æ“¦é™¤çš„æ—¶å€™ï¼Œå¦‚æœæ³›å‹ç±»â¾¥çš„ç±»å‹å‚æ•°æ²¡æœ‰æŒ‡å®šä¸Šé™ï¼Œåˆ™ä¼šè¢«è½¬æˆ Object ç±»å‹ï¼Œå¦‚æœæŒ‡å®šäº†ä¸Šé™ï¼Œåˆ™ä¼šè¢«è½¬æ¢æˆå¯¹åº”çš„ç±»å‹ä¸Šé™ã€‚
3. Java ä¸­çš„æ³›å‹åŸºæœ¬ä¸Šéƒ½æ˜¯åœ¨ç¼–è¯‘å™¨è¿™ä¸ªå±‚æ¬¡æ¥å®ç°çš„ã€‚â½£æˆçš„ Java å­—èŠ‚ç ä¸­æ˜¯ä¸åŒ…å«æ³›å‹ä¸­çš„ç±»å‹ä¿¡æ¯çš„ã€‚ä½¿â½¤æ³›å‹çš„æ—¶å€™åŠ ä¸Šçš„ç±»å‹å‚æ•°ï¼Œä¼šåœ¨ç¼–è¯‘å™¨ç¼–è¯‘çš„æ—¶å€™æ“¦é™¤æ‰ï¼Œè¿™ä¸ªè¿‡ç¨‹å°±ç§°ä¸ºç±»å‹æ“¦é™¤

## æ³›å‹æ“¦é™¤

Java ä¸­çš„æ³›å‹åŸºæœ¬ä¸Šéƒ½æ˜¯åœ¨ç¼–è¯‘å™¨è¿™ä¸ªå±‚æ¬¡æ¥å®ç°çš„ã€‚åœ¨ç”Ÿæˆçš„ Java å­—èŠ‚ç ä¸­æ˜¯ä¸åŒ…å«æ³›å‹ä¸­çš„ç±»å‹ä¿¡æ¯çš„ã€‚ä½¿ç”¨æ³›å‹çš„æ—¶å€™åŠ ä¸Šçš„ç±»å‹å‚æ•°ï¼Œä¼šåœ¨ç¼–è¯‘å™¨åœ¨ç¼–è¯‘çš„æ—¶å€™å»æ‰ã€‚è¿™ä¸ªè¿‡ç¨‹å°±ç§°ä¸ºç±»å‹æ“¦é™¤ã€‚

> å¦‚åœ¨ä»£ç ä¸­å®šä¹‰çš„ List

æ¡ˆä¾‹ 1ï¼š

```java
public class Test4 {
	public static void main(String[] args) {
		ArrayList<String> arrayList1=new ArrayList<String>();
		arrayList1.add("abc");
		ArrayList<Integer> arrayList2=new ArrayList<Integer>();
		arrayList2.add(123);
		System.out.println(arrayList1.getClass()==arrayList2.getClass()); // true
	}
}
```

åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸¤ä¸ª ArrayList æ•°ç»„ï¼Œä¸è¿‡ä¸€ä¸ªæ˜¯ ArrayList æ³›å‹ç±»å‹ï¼Œåªèƒ½å­˜å‚¨å­—ç¬¦ä¸²ã€‚ä¸€ä¸ªæ˜¯ ArrayList æ³›å‹ç±»å‹ï¼Œåªèƒ½å­˜å‚¨æ•´å½¢ã€‚æœ€åï¼Œæˆ‘ä»¬é€šè¿‡ arrayList1 å¯¹è±¡å’Œ arrayList2 å¯¹è±¡çš„ getClass æ–¹æ³•è·å–å®ƒä»¬çš„ç±»çš„ä¿¡æ¯ï¼Œæœ€åå‘ç°ç»“æœä¸º trueã€‚è¯´æ˜æ³›å‹ç±»å‹ String å’Œ Integer éƒ½è¢«æ“¦é™¤æ‰äº†ï¼Œåªå‰©ä¸‹äº†åŸå§‹ç±»å‹ã€‚

æ¡ˆä¾‹ 2ï¼š

```java
public class Test4 {
	public static void main(String[] args) throws IllegalArgumentException, SecurityException, IllegalAccessException, InvocationTargetException, NoSuchMethodException {
		ArrayList<Integer> arrayList3=new ArrayList<Integer>();
		arrayList3.add(1);//è¿™æ ·è°ƒç”¨addæ–¹æ³•åªèƒ½å­˜å‚¨æ•´å½¢ï¼Œå› ä¸ºæ³›å‹ç±»å‹çš„å®ä¾‹ä¸ºInteger
		arrayList3.getClass().getMethod("add", Object.class).invoke(arrayList3, "asd");
		for (int i=0;i<arrayList3.size();i++) {
			System.out.println(arrayList3.get(i));
		}
	}
```

åœ¨ç¨‹åºä¸­å®šä¹‰äº†ä¸€ä¸ª ArrayList æ³›å‹ç±»å‹å®ä¾‹åŒ–ä¸º Integer çš„å¯¹è±¡ï¼Œå¦‚æœç›´æ¥è°ƒç”¨ add æ–¹æ³•ï¼Œé‚£ä¹ˆåªèƒ½å­˜å‚¨æ•´å½¢çš„æ•°æ®ã€‚ä¸è¿‡å½“æˆ‘ä»¬åˆ©ç”¨åå°„è°ƒç”¨ add æ–¹æ³•çš„æ—¶å€™ï¼Œå´å¯ä»¥å­˜å‚¨å­—ç¬¦ä¸²ã€‚è¿™è¯´æ˜äº† Integer æ³›å‹å®ä¾‹åœ¨ç¼–è¯‘ä¹‹åè¢«æ“¦é™¤äº†ï¼Œåªä¿ç•™äº†åŸå§‹ç±»å‹ï¼Œåœ¨è¿è¡Œæ—¶ä¹Ÿå¯ä»¥æ·»åŠ ã€‚

## ç±»å‹æ“¦é™¤å¼•èµ·çš„é—®é¢˜åŠè§£å†³æ–¹æ³•

### å…ˆæ£€æŸ¥ï¼Œåœ¨ç¼–è¯‘

Java ç¼–è¯‘å™¨æ˜¯é€šè¿‡å…ˆæ£€æŸ¥ä»£ç ä¸­æ³›å‹çš„ç±»å‹ï¼Œç„¶åå†è¿›è¡Œç±»å‹æ“¦é™¤ï¼Œåœ¨è¿›è¡Œç¼–è¯‘çš„ã€‚

```java
public static  void main(String[] args) {
	ArrayList<String> arrayList=new ArrayList<String>();
	arrayList.add("123");
	arrayList.add(123); // ç¼–è¯‘é”™è¯¯
}
```

### æ£€æŸ¥ç¼–è¯‘çš„å¯¹è±¡å’Œå¼•ç”¨ä¼ é€’çš„é—®é¢˜

```java
ArrayList<String> arrayList1 = new ArrayList(); // ç¬¬ä¸€ç§ æƒ…å†µ
ArrayList arrayList2 = new ArrayList<String>();// ç¬¬äºŒç§ æƒ…å†µ
```

æœ¬æ¥ç±»å‹æ£€æŸ¥å°±æ˜¯ç¼–è¯‘æ—¶å®Œæˆçš„ã€‚new ArrayList() åªæ˜¯åœ¨å†…å­˜ä¸­å¼€è¾Ÿä¸€ä¸ªå­˜å‚¨ç©ºé—´ï¼Œå¯ä»¥å­˜å‚¨ä»»ä½•çš„ç±»å‹å¯¹è±¡ã€‚è€ŒçœŸæ­£æ¶‰åŠç±»å‹æ£€æŸ¥çš„æ˜¯å®ƒçš„å¼•ç”¨ï¼Œå› ä¸ºæˆ‘ä»¬æ˜¯ä½¿ç”¨å®ƒå¼•ç”¨ arrayList1 æ¥è°ƒç”¨å®ƒçš„æ–¹æ³•ï¼Œæ¯”å¦‚è¯´è°ƒç”¨ add() æ–¹æ³•ã€‚æ‰€ä»¥ arrayList1 å¼•ç”¨èƒ½å®Œæˆæ³›å‹ç±»å‹çš„æ£€æŸ¥ã€‚

> ç±»å‹æ£€æŸ¥å°±æ˜¯é’ˆå¯¹å¼•ç”¨çš„ï¼Œè°æ˜¯ä¸€ä¸ªå¼•ç”¨ï¼Œç”¨è¿™ä¸ªå¼•ç”¨è°ƒç”¨æ³›å‹æ–¹æ³•ï¼Œå°±ä¼šå¯¹è¿™ä¸ªå¼•ç”¨è°ƒç”¨çš„æ–¹æ³•è¿›è¡Œç±»å‹æ£€æµ‹ï¼Œè€Œæ— å…³å®ƒçœŸæ­£å¼•ç”¨çš„å¯¹è±¡ã€‚

```java
public class Test10 {
	public static void main(String[] args) {
		
		ArrayList<String> arrayList1=new ArrayList();
		arrayList1.add("1");//ç¼–è¯‘é€šè¿‡
		arrayList1.add(1);//ç¼–è¯‘é”™è¯¯
		String str1=arrayList1.get(0);//è¿”å›ç±»å‹å°±æ˜¯String
		
		ArrayList arrayList2=new ArrayList<String>();
		arrayList2.add("1");//ç¼–è¯‘é€šè¿‡
		arrayList2.add(1);//ç¼–è¯‘é€šè¿‡
		Object object=arrayList2.get(0);//è¿”å›ç±»å‹å°±æ˜¯Object
		
		new ArrayList<String>().add("11");//ç¼–è¯‘é€šè¿‡
		new ArrayList<String>().add(22);//ç¼–è¯‘é”™è¯¯
		String string=new ArrayList<String>().get(0);//è¿”å›ç±»å‹å°±æ˜¯String
	}
}
```

### è‡ªåŠ¨ç±»å‹è½¬æ¢

å› ä¸ºç±»å‹æ“¦é™¤çš„é—®é¢˜ï¼Œæ‰€ä»¥æ‰€æœ‰çš„æ³›å‹ç±»å‹å˜é‡æœ€åéƒ½ä¼šè¢«æ›¿æ¢ä¸ºåŸå§‹ç±»å‹ã€‚è¿™æ ·å°±å¼•èµ·äº†ä¸€ä¸ªé—®é¢˜ï¼Œæ—¢ç„¶éƒ½è¢«æ›¿æ¢ä¸ºåŸå§‹ç±»å‹ï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆæˆ‘ä»¬åœ¨è·å–çš„æ—¶å€™ï¼Œä¸éœ€è¦è¿›è¡Œå¼ºåˆ¶ç±»å‹è½¬æ¢å‘¢ï¼Ÿçœ‹ä¸‹ ArrayList å’Œ get æ–¹æ³•ï¼š

```java
public E get(int index) {
	RangeCheck(index);
    return (E) elementData[index];
}
```

> çœ‹ä»¥çœ‹åˆ°ï¼Œåœ¨ return ä¹‹å‰ï¼Œä¼šæ ¹æ®æ³›å‹å˜é‡è¿›è¡Œå¼ºè½¬ã€‚

å†™äº†ä¸ªç®€å•çš„æµ‹è¯•ä»£ç ï¼š

```java
public class Test {
    public static void main(String[] args) {
        ArrayList<Date> list=new ArrayList<Date>();
        list.add(new Date());
        Date myDate=list.get(0);
    }
}
```

ç„¶ååç¼–äº†ä¸‹å­—èŠ‚ç ï¼Œå¦‚ä¸‹ï¼š

```java
public static void main(java.lang.String[]);
Code:
0: new #16 // class java/util/ArrayList
3: dup
4: invokespecial #18 // Method java/util/ArrayList."<init
:()V
7: astore_1
8: aload_1
9: new #19 // class java/util/Date
12: dup
13: invokespecial #21 // Method java/util/Date."<init>":()
 
16: invokevirtual #22 // Method java/util/ArrayList.add:(L
va/lang/Object;)Z
19: pop
20: aload_1
21: iconst_0
22: invokevirtual #26 // Method java/util/ArrayList.get:(I
java/lang/Object;
25: checkcast #19 // class java/util/Date
28: astore_2
29: return
```

çœ‹ç¬¬ 22 ï¼Œå®ƒè°ƒç”¨çš„æ˜¯ ArrayList.get() æ–¹æ³•ï¼Œæ–¹æ³•è¿”å›å€¼æ˜¯ Objectï¼Œè¯´æ˜ç±»å‹æ“¦é™¤äº†ã€‚ç„¶åç¬¬ 25ï¼Œå®ƒåšäº†ä¸€ä¸ª checkcast æ“ä½œï¼Œå³æ£€æŸ¥ç±»å‹ `#19`ï¼Œ åœ¨åœ¨ä¸Šé¢æ‰¾ `#19` å¼•ç”¨çš„ç±»å‹ï¼Œä»–æ˜¯<br>9: new `#19` // class java/util/Date<br>æ˜¯ä¸€ä¸ª Date ç±»å‹ï¼Œå³åš Date ç±»å‹çš„å¼ºè½¬ã€‚<br>æ‰€ä»¥ä¸æ˜¯åœ¨ get æ–¹æ³•é‡Œå¼ºè½¬çš„ï¼Œæ˜¯åœ¨ä½ è°ƒç”¨çš„åœ°æ–¹å¼ºè½¬çš„ã€‚

### ç±»å‹æ“¦é™¤ä¸å¤šæ€çš„å†²çªå’Œè§£å†³æ–¹æ³•

ç°åœ¨æœ‰è¿™æ ·ä¸€ä¸ªæ³›å‹ç±»ï¼š

```java
class Pair<T> {
	private T value;
	public T getValue() {
		return value;
	}
	public void setValue(T value) {
		this.value = value;
	}
}
```

ä¸€ä¸ªå­ç±»ç»§æ‰¿å®ƒï¼š

```java
class DateInter extends Pair<Date> {
	@Override
	public void setValue(Date value) {
		super.setValue(value);
	}
	@Override
	public Date getValue() {
		return super.getValue();
	}
}
```

åœ¨è¿™ä¸ªå­ç±»ä¸­ï¼Œæˆ‘ä»¬è®¾å®šçˆ¶ç±»çš„æ³›å‹ç±»å‹ä¸º `Pair<Date>`ï¼Œåœ¨å­ç±»ä¸­ï¼Œæˆ‘ä»¬è¦†ç›–äº†çˆ¶ç±»çš„ä¸¤ä¸ªæ–¹æ³•ï¼Œæˆ‘ä»¬çš„åŸæ„æ˜¯è¿™æ ·çš„ï¼š<br>å°†çˆ¶ç±»çš„æ³›å‹ç±»å‹é™å®šä¸º Dateï¼Œé‚£ä¹ˆçˆ¶ç±»é‡Œé¢çš„ä¸¤ä¸ªæ–¹æ³•çš„å‚æ•°éƒ½ä¸º Date ç±»å‹ï¼š

```java
class Pair {
	private Date value;
	public Date getValue() {
		return value;
	}
	public void setValue(Date value) {
		this.value = value;
	}
}
```

> å¯æ˜¯ç”±äºç§ç§åŸå› ï¼Œè™šæ‹Ÿæœºå¹¶ä¸èƒ½å°†æ³›å‹ç±»å‹å˜ä¸º Dateï¼Œåªèƒ½å°†ç±»å‹æ“¦é™¤æ‰ï¼Œå˜ä¸ºåŸå§‹ç±»å‹ Objectã€‚è¿™æ ·ï¼Œæˆ‘ä»¬çš„æœ¬æ„æ˜¯è¿›è¡Œé‡å†™ï¼Œå®ç°å¤šæ€ã€‚å¯æ˜¯ç±»å‹æ“¦é™¤åï¼Œåªèƒ½å˜ä¸ºäº†é‡è½½ã€‚è¿™æ ·ï¼Œç±»å‹æ“¦é™¤å°±å’Œå¤šæ€æœ‰äº†å†²çªã€‚

äºæ˜¯ JVM é‡‡ç”¨äº†ä¸€ä¸ªç‰¹æ®Šçš„æ–¹æ³•ï¼Œæ¥å®Œæˆè¿™é¡¹åŠŸèƒ½ï¼Œé‚£å°±æ˜¯**æ¡¥æ–¹æ³•**ã€‚

é¦–å…ˆï¼Œæˆ‘ä»¬ç”¨ javap -c className çš„æ–¹å¼åç¼–è¯‘ä¸‹ DateInter å­ç±»çš„å­—èŠ‚ç ï¼Œç»“æœå¦‚ä¸‹ï¼š

```java
class com.tao.test.DateInter extends com.tao.test.Pair<java.util.Date> {
  com.tao.test.DateInter();
    Code:
       0: aload_0
       1: invokespecial #8                  // Method com/tao/test/Pair."<init>"
:()V
       4: return
 
  public void setValue(java.util.Date);  //æˆ‘ä»¬é‡å†™çš„setValueæ–¹æ³•
    Code:
       0: aload_0
       1: aload_1
       2: invokespecial #16                 // Method com/tao/test/Pair.setValue
:(Ljava/lang/Object;)V
       5: return
 
  public java.util.Date getValue();    //æˆ‘ä»¬é‡å†™çš„getValueæ–¹æ³•
    Code:
       0: aload_0
       1: invokespecial #23                 // Method com/tao/test/Pair.getValue
:()Ljava/lang/Object;
       4: checkcast     #26                 // class java/util/Date
       7: areturn
 
  public java.lang.Object getValue();     //ç¼–è¯‘æ—¶ç”±ç¼–è¯‘å™¨ç”Ÿæˆçš„å·§æ–¹æ³•
    Code:
       0: aload_0
       1: invokevirtual #28                 // Method getValue:()Ljava/util/Date å»è°ƒç”¨æˆ‘ä»¬é‡å†™çš„getValueæ–¹æ³•
;
       4: areturn
 
  public void setValue(java.lang.Object);   //ç¼–è¯‘æ—¶ç”±ç¼–è¯‘å™¨ç”Ÿæˆçš„å·§æ–¹æ³•
    Code:
       0: aload_0
       1: aload_1
       2: checkcast     #26                 // class java/util/Date
       5: invokevirtual #30                 // Method setValue:(Ljava/util/Date;   å»è°ƒç”¨æˆ‘ä»¬é‡å†™çš„setValueæ–¹æ³•
)V
       8: return
}
```

ä»ç¼–è¯‘çš„ç»“æœæ¥çœ‹ï¼Œæˆ‘ä»¬æœ¬æ„é‡å†™ setValue å’Œ getValue æ–¹æ³•çš„å­ç±»ï¼Œç«Ÿç„¶æœ‰ 4 ä¸ªæ–¹æ³•ï¼Œå…¶å®ä¸ç”¨æƒŠå¥‡ï¼Œæœ€åçš„ä¸¤ä¸ªæ–¹æ³•ï¼Œå°±æ˜¯ç¼–è¯‘å™¨è‡ªå·±ç”Ÿæˆçš„æ¡¥æ–¹æ³•ã€‚å¯ä»¥çœ‹åˆ°æ¡¥æ–¹æ³•çš„å‚æ•°ç±»å‹éƒ½æ˜¯ Objectï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå­ç±»ä¸­çœŸæ­£è¦†ç›–çˆ¶ç±»ä¸¤ä¸ªæ–¹æ³•çš„å°±æ˜¯è¿™ä¸¤ä¸ªæˆ‘ä»¬çœ‹ä¸åˆ°çš„æ¡¥æ–¹æ³•ã€‚è€Œæ‰“åœ¨æˆ‘ä»¬è‡ªå·±å®šä¹‰çš„ setvalue å’Œ getValue æ–¹æ³•ä¸Šé¢çš„@Oveerride åªä¸è¿‡æ˜¯å‡è±¡ã€‚è€Œæ¡¥æ–¹æ³•çš„å†…éƒ¨å®ç°ï¼Œå°±åªæ˜¯å»è°ƒç”¨æˆ‘ä»¬è‡ªå·±é‡å†™çš„é‚£ä¸¤ä¸ªæ–¹æ³•ã€‚

> æ‰€ä»¥ï¼Œè™šæ‹Ÿæœºå·§å¦™çš„ä½¿ç”¨äº†æ¡¥æ–¹æ³•ï¼Œæ¥è§£å†³äº†ç±»å‹æ“¦é™¤å’Œå¤šæ€çš„å†²çªã€‚

ä¸è¿‡ï¼Œè¦æåˆ°ä¸€ç‚¹ï¼Œè¿™é‡Œé¢çš„ setValue å’Œ getValue è¿™ä¸¤ä¸ªæ¡¥æ–¹æ³•çš„æ„ä¹‰åˆæœ‰ä¸åŒã€‚

### æ³›å‹ç±»å‹å˜é‡ä¸èƒ½æ˜¯åŸºæœ¬æ•°æ®ç±»å‹

ä¸èƒ½ç”¨ç±»å‹å‚æ•°æ›¿æ¢åŸºæœ¬ç±»å‹ã€‚å°±æ¯”å¦‚ï¼Œæ²¡æœ‰ ArrayListï¼Œåªæœ‰ ArrayListã€‚å› ä¸ºå½“ç±»å‹æ“¦é™¤åï¼ŒArrayList çš„åŸå§‹ç±»å‹å˜ä¸º Objectï¼Œä½†æ˜¯ Object ç±»å‹ä¸èƒ½å­˜å‚¨ double å€¼ï¼Œåªèƒ½å¼•ç”¨ Double çš„å€¼ã€‚

### è¿è¡Œæ—¶ç±»å‹æŸ¥è¯¢

```java
ArrayList<String> arrayList = new ArrayList<String>();  // å› ä¸ºç±»å‹æ“¦é™¤ä¹‹åï¼ŒArrayList<String>åªå‰©ä¸‹åŸå§‹ç±»å‹ï¼Œæ³›å‹ä¿¡æ¯Stringä¸å­˜åœ¨äº†ã€‚

// é‚£ä¹ˆï¼Œè¿è¡Œæ—¶è¿›è¡Œç±»å‹æŸ¥è¯¢çš„æ—¶å€™ä½¿ç”¨ä¸‹é¢çš„æ–¹æ³•æ˜¯é”™è¯¯çš„
if( arrayList instanceof ArrayList<String>) 

// Javaé™å®šäº†è¿™ç§ç±»å‹æŸ¥è¯¢çš„æ–¹å¼
if( arrayList instanceof ArrayList<?>)
```

### æ³›å‹ç±»å‹çš„ä¸èƒ½å®ä¾‹åŒ–

## Ref

- [x] java æ³›å‹ï¼ˆäºŒï¼‰ã€æ³›å‹çš„å†…éƒ¨åŸç†ï¼šç±»å‹æ“¦é™¤ä»¥åŠç±»å‹æ“¦é™¤å¸¦æ¥çš„é—®é¢˜ <https://blog.csdn.net/lonelyroamer/article/details/7868820>

> è®²è§£çš„å¾ˆè¯¦ç»†

# æ³›å‹é€šé…ç¬¦ä¹‹? super å’Œ? extend

## æ³›å‹ä¸­çš„é€šé…ç¬¦

### é€šé…ç¬¦?

ç”¨é€šé…ç¬¦? ï¼Œè®©æ³›å‹å…·å¤‡å¯å˜æ€§

### `? extend T` ä¸Šç•Œé€šé…ç¬¦/åå˜

```java
List<Button> buttons = new ArrayList<Button>();
List<TextView> textViews = buttons;
// ğŸ‘† å¤šæ€ç”¨åœ¨è¿™é‡Œä¼šæŠ¥é”™ incompatible types: List<Button> cannot be converted to List<TextView>
```

ä¸Šé¢å°† buttons èµ‹å€¼ç»™ textViews ç¼–è¯‘å™¨ä¼šæç¤ºé”™è¯¯ï¼Œè¿™æ˜¯å› ä¸ºæ³›å‹å…·æœ‰ä¸å¯å˜æ€§ï¼ŒList å’Œ List æ˜¯ä¸¤ç§ä¸åŒçš„ç±»å‹ã€‚

æ€ä¹ˆè§£å†³ï¼Ÿ

```java
List<Button> buttons = new ArrayList<Button>();
//  ğŸ‘‡
List<? extends TextView> textViews = buttons;
```

è¿™ä¸ª `? extends` å«åš `ã€Œä¸Šç•Œé€šé…ç¬¦ã€`ï¼Œå¯ä»¥ä½¿ Java æ³›å‹å…·æœ‰ã€Œåå˜æ€§ Covarianceã€ï¼Œåå˜å°±æ˜¯å…è®¸ä¸Šé¢çš„èµ‹å€¼æ˜¯åˆæ³•çš„ã€‚

> åœ¨ç»§æ‰¿å…³ç³»æ ‘ä¸­ï¼Œå­ç±»ç»§æ‰¿è‡ªçˆ¶ç±»ï¼Œå¯ä»¥è®¤ä¸ºçˆ¶ç±»åœ¨ä¸Šï¼Œå­ç±»åœ¨ä¸‹ã€‚extends é™åˆ¶äº†æ³›å‹ç±»å‹çš„çˆ¶ç±»å‹ï¼Œæ‰€ä»¥å«ä¸Šç•Œã€‚

å®ƒæœ‰ä¸¤å±‚æ„æ€ï¼š

1. å…¶ä¸­ ? æ˜¯ä¸ªé€šé…ç¬¦ï¼Œè¡¨ç¤ºè¿™ä¸ª List çš„æ³›å‹ç±»å‹æ˜¯ä¸€ä¸ªæœªçŸ¥ç±»å‹ã€‚
2. extends é™åˆ¶äº†è¿™ä¸ªæœªçŸ¥ç±»å‹çš„ä¸Šç•Œï¼Œä¹Ÿå°±æ˜¯æ³›å‹ç±»å‹å¿…é¡»æ»¡è¶³è¿™ä¸ª extends çš„é™åˆ¶æ¡ä»¶ï¼Œè¿™é‡Œå’Œå®šä¹‰ class çš„ extends å…³é”®å­—æœ‰ç‚¹ä¸ä¸€æ ·ï¼š
   - å®ƒçš„èŒƒå›´ä¸ä»…æ˜¯æ‰€æœ‰ç›´æ¥å’Œé—´æ¥å­ç±»ï¼Œè¿˜åŒ…æ‹¬ä¸Šç•Œå®šä¹‰çš„çˆ¶ç±»æœ¬èº«ï¼Œä¹Ÿå°±æ˜¯ TextViewã€‚
   - å®ƒè¿˜æœ‰ implements çš„æ„æ€ï¼Œå³è¿™é‡Œçš„ä¸Šç•Œä¹Ÿå¯ä»¥æ˜¯ interfaceã€‚

ä¸‹é¢ä¹Ÿæ˜¯å¯ä»¥çš„ï¼š

```java
List<? extends TextView> textViews = new ArrayList<TextView>(); // ğŸ‘ˆ æœ¬èº«
List<? extends TextView> textViews = new ArrayList<Button>(); // ğŸ‘ˆ ç›´æ¥å­ç±»
List<? extends TextView> textViews = new ArrayList<RadioButton>(); // ğŸ‘ˆ é—´æ¥å­ç±»
```

åœ¨ä½¿ç”¨äº†ä¸Šç•Œé€šé…ç¬¦ä¹‹åï¼ŒList çš„ä½¿ç”¨ä¸Šæœ‰æ²¡æœ‰ä»€ä¹ˆé—®é¢˜ï¼š

```java
List<? extends TextView> textViews = new ArrayList<Button>();
TextView textView = textViews.get(0); // ğŸ‘ˆ get å¯ä»¥
textViews.add(textView);
//             ğŸ‘† add ä¼šæŠ¥é”™ï¼Œno suitable method found for add(TextView)
```

`List<? extends TextView>` çš„æ³›å‹ç±»å‹æ˜¯ä¸ªæœªçŸ¥ç±»å‹ ?ï¼Œç¼–è¯‘å™¨ä¹Ÿä¸ç¡®å®šå®ƒæ˜¯å•¥ç±»å‹ï¼Œåªæ˜¯æœ‰ä¸ªé™åˆ¶æ¡ä»¶ã€‚

1. get()

ç”±äºå®ƒæ»¡è¶³ ? extends TextView çš„é™åˆ¶æ¡ä»¶ï¼Œæ‰€ä»¥ get å‡ºæ¥çš„å¯¹è±¡ï¼Œè‚¯å®šæ˜¯ TextView çš„å­ç±»å‹ï¼Œæ ¹æ®å¤šæ€çš„ç‰¹æ€§ï¼Œèƒ½å¤Ÿèµ‹å€¼ç»™ TextViewï¼Œå•°å—¦ä¸€å¥ï¼Œèµ‹å€¼ç»™ View ä¹Ÿæ˜¯æ²¡é—®é¢˜çš„ã€‚

2. add

- `List<? extends TextView>` ç”±äºç±»å‹æœªçŸ¥ï¼Œå®ƒå¯èƒ½æ˜¯ Listï¼Œä¹Ÿå¯èƒ½æ˜¯ Listï¼›å¯¹äºå‰è€…ï¼Œæ˜¾ç„¶æˆ‘ä»¬è¦æ·»åŠ  TextView æ˜¯ä¸å¯ä»¥çš„
- å®é™…æƒ…å†µæ˜¯ç¼–è¯‘å™¨æ— æ³•ç¡®å®šåˆ°åº•å±äºå“ªä¸€ç§ï¼Œæ— æ³•ç»§ç»­æ‰§è¡Œä¸‹å»ï¼Œå°±æŠ¥é”™äº†ã€‚

é‚£æˆ‘å¹²è„†ä¸è¦ extends TextView ï¼Œåªç”¨é€šé…ç¬¦ `?` å‘¢ï¼Ÿ

è¿™æ ·ä½¿ç”¨ `List<?>` å…¶å®æ˜¯ `List<? extends Object>` çš„ç¼©å†™ã€‚

```java
List<Button> buttons = new ArrayList<>();

List<?> list = buttons;
Object obj = list.get(0);

list.add(obj); // ğŸ‘ˆ è¿™é‡Œè¿˜æ˜¯ä¼šæŠ¥é”™
```

> å’Œå‰é¢çš„ä¾‹å­ä¸€æ ·ï¼Œç¼–è¯‘å™¨æ²¡æ³•ç¡®å®š ? çš„ç±»å‹ï¼Œæ‰€ä»¥è¿™é‡Œå°±åªèƒ½ get åˆ° Object å¯¹è±¡ã€‚

åŒæ—¶ç¼–è¯‘å™¨ä¸ºäº†ä¿è¯ç±»å‹å®‰å…¨ï¼Œä¹Ÿä¸èƒ½å‘ `List<?>` ä¸­æ·»åŠ ä»»ä½•ç±»å‹çš„å¯¹è±¡ï¼Œç†ç”±åŒä¸Šã€‚

ç”±äº add çš„è¿™ä¸ªé™åˆ¶ï¼Œä½¿ç”¨äº† `? extends` æ³›å‹é€šé…ç¬¦çš„ Listï¼Œåªèƒ½å¤Ÿå‘å¤–æä¾›æ•°æ®è¢«æ¶ˆè´¹ï¼Œä»è¿™ä¸ªè§’åº¦æ¥è®²ï¼Œå‘å¤–æä¾›æ•°æ®çš„ä¸€æ–¹ç§°ä¸ºã€Œç”Ÿäº§è€… Producerã€ã€‚å¯¹åº”çš„è¿˜æœ‰ä¸€ä¸ªæ¦‚å¿µå«ã€Œæ¶ˆè´¹è€… Consumerã€ï¼Œå¯¹åº” Java é‡Œé¢å¦ä¸€ä¸ªæ³›å‹é€šé…ç¬¦ ? superã€‚

å¦å¤–ä¸€ä¸ªæ¡ˆä¾‹ï¼š

```java
List<? extends Number> numbers = new ArrayList<Number>(); // correct
List<? extends Number> numbers2 = new ArrayList<Integer>(); // correct
List<? extends Number> numbers3 = new ArrayList<Object>(); // wrong
```

### `? super T` ä¸‹ç•Œé€šé…ç¬¦/é€†å˜

```java
List<? super Button> buttons = new ArrayList<TextView>();
```

> è¿™ä¸ª ? super å«åšã€Œä¸‹ç•Œé€šé…ç¬¦ã€ï¼Œå¯ä»¥ä½¿ Java æ³›å‹å…·æœ‰ã€Œé€†å˜æ€§ Contravarianceã€ã€‚

1. é€šé…ç¬¦ ? è¡¨ç¤º List çš„æ³›å‹ç±»å‹æ˜¯ä¸€ä¸ªæœªçŸ¥ç±»å‹ã€‚
2. super é™åˆ¶äº†è¿™ä¸ªæœªçŸ¥ç±»å‹çš„ä¸‹ç•Œï¼Œä¹Ÿå°±æ˜¯æ³›å‹ç±»å‹å¿…é¡»æ»¡è¶³è¿™ä¸ª super çš„é™åˆ¶æ¡ä»¶ã€‚
   - super æˆ‘ä»¬åœ¨ç±»çš„æ–¹æ³•é‡Œé¢ç»å¸¸ç”¨åˆ°ï¼Œè¿™é‡Œçš„èŒƒå›´ä¸ä»…åŒ…æ‹¬ Button çš„ç›´æ¥å’Œé—´æ¥çˆ¶ç±»ï¼Œä¹ŸåŒ…æ‹¬ä¸‹ç•Œ Button æœ¬èº«ã€‚
   - super åŒæ ·æ”¯æŒ interfaceã€‚

ä¸‹é¢å‡ ç§æƒ…å†µéƒ½æ˜¯å¯ä»¥çš„ï¼š

```java
List<? super Button> buttons = new ArrayList<Button>(); // ğŸ‘ˆ æœ¬èº«
List<? super Button> buttons = new ArrayList<TextView>(); // ğŸ‘ˆ ç›´æ¥çˆ¶ç±»
List<? super Button> buttons = new ArrayList<Object>(); // ğŸ‘ˆ é—´æ¥çˆ¶ç±»
```

ä½¿ç”¨äº†ä¸‹ç•Œé€šé…ç¬¦çš„ Listï¼Œæˆ‘ä»¬å†çœ‹çœ‹å®ƒçš„ get å’Œ add æ“ä½œï¼š

```java
List<? super Button> buttons = new ArrayList<TextView>();
Object object = buttons.get(0); // ğŸ‘ˆ get å‡ºæ¥çš„æ˜¯ Object ç±»å‹
Button button = ...
buttons.add(button); // ğŸ‘ˆ add æ“ä½œæ˜¯å¯ä»¥çš„
```

ä½¿ç”¨ä¸‹ç•Œé€šé…ç¬¦ `? super` çš„æ³›å‹ Listï¼Œåªèƒ½è¯»å–åˆ° Object å¯¹è±¡ï¼Œä¸€èˆ¬æ²¡æœ‰ä»€ä¹ˆå®é™…çš„ä½¿ç”¨åœºæ™¯ï¼Œé€šå¸¸ä¹Ÿåªæ‹¿å®ƒæ¥æ·»åŠ æ•°æ®ï¼Œå¯¹äº `List<? super Button>` ä»å¤–å–æ•°æ®ï¼Œä¹Ÿå°±æ˜¯æ¶ˆè´¹å·²æœ‰çš„ `List<? super Button>`ï¼Œå¾€é‡Œé¢æ·»åŠ  Buttonï¼Œå› æ­¤è¿™ç§æ³›å‹ç±»å‹å£°æ˜ç§°ä¹‹ä¸ºã€Œæ¶ˆè´¹è€… Consumerã€ã€‚

æ·»åŠ å…ƒç´ ï¼Œå¯ä»¥æ·»åŠ ä¸º T åŠ T çš„å­ç±»ã€‚

```java
List<? super Fruit> fruits2 = new ArrayList<Fruit>();
//        fruits2.add(new Fruit()); // ok 
//        fruits2.add(new Apple()); // ok 
//        fruits2.add(new Orange()); // ok 
//        fruits2.add(new Object()); // ç¼–è¯‘é”™è¯¯
```

### å°ç»“

Java çš„æ³›å‹æœ¬èº«æ˜¯ä¸æ”¯æŒåå˜å’Œé€†å˜çš„ã€‚

1. å¯ä»¥ä½¿ç”¨æ³›å‹é€šé…ç¬¦ `? extends` æ¥ä½¿æ³›å‹æ”¯æŒåå˜ï¼Œä½†æ˜¯ `ã€Œåªèƒ½è¯»å–ä¸èƒ½ä¿®æ”¹ã€`ï¼Œè¿™é‡Œçš„ä¿®æ”¹ä»…æŒ‡å¯¹æ³›å‹é›†åˆæ·»åŠ å…ƒç´ ï¼Œå¦‚æœæ˜¯ remove(int index) ä»¥åŠ clear å½“ç„¶æ˜¯å¯ä»¥çš„ã€‚
2. å¯ä»¥ä½¿ç”¨æ³›å‹é€šé…ç¬¦ `? super` æ¥ä½¿æ³›å‹æ”¯æŒé€†å˜ï¼Œä½†æ˜¯ `ã€Œåªèƒ½ä¿®æ”¹ä¸èƒ½è¯»å–ã€`ï¼Œè¿™é‡Œè¯´çš„ä¸èƒ½è¯»å–æ˜¯æŒ‡ä¸èƒ½æŒ‰ç…§æ³›å‹ç±»å‹è¯»å–ï¼Œä½ å¦‚æœæŒ‰ç…§ Object è¯»å‡ºæ¥å†å¼ºè½¬å½“ç„¶ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚

> è¿™è¢«ç§°ä¸º PECS æ³•åˆ™ï¼šã€ŒProducer-Extends, Consumer-Superã€ã€‚

## PECS åŸåˆ™

PECSï¼ˆProducer Extends Consumer Superï¼‰

### PE extends(? extends)ï¼Œåå˜ï¼Œå–

> é¢‘ç¹å¾€å¤–å–å†…å®¹çš„ï¼Œé€‚åˆç”¨ä¸Šç•Œ extends

å½“åªæƒ³ä»é›†åˆä¸­è·å–å…ƒç´ ï¼Œè¯·æŠŠè¿™ä¸ªé›†åˆçœ‹æˆç”Ÿäº§è€…ï¼Œè¯·ä½¿ç”¨ `<? extends T>`ï¼Œè¿™å°±æ˜¯ Producer extends åŸåˆ™ï¼ŒPECS åŸåˆ™ä¸­çš„ PE éƒ¨åˆ†ã€‚

### CS super(? super)ï¼Œé€†å˜ï¼Œ å­˜

> ç»å¸¸å¾€é‡Œæ’å…¥çš„ï¼Œé€‚åˆç”¨ä¸‹ç•Œ super

```java
public class PECS {

    public static void main(String[] args) {
//       System.out.println("Hello PECS");

        List<Fruit> fruitList = new ArrayList<Fruit>();
        fruitList.add(new Apple());
        fruitList.add(new Orange());
//        getOutFruits(fruitList); // ok
//        getOutFruits2(fruitList); // ok


        List<Apple> apples = new ArrayList<Apple>();
        apples.add(new Apple());
//        getOutFruits(apples); ç¼–è¯‘é”™è¯¯
//        getOutFruits((List<Fruit>)apples); // å¼ºåˆ¶ç±»å‹è½¬æ¢ï¼ŒåŒæ ·ç¼–è¯‘é”™è¯¯ï¼Œä¸å…¼å®¹çš„ç±»å‹: List<Apple>æ— æ³•è½¬æ¢ä¸ºList<Fruit>
//        getOutFruits2(apples); // ok

        List<? extends Fruit> basket = apples;//æŒ‰ä¸Šä¸€ä¸ªä¾‹å­ï¼Œè¿™ä¸ªæ˜¯å¯è¡Œçš„
        for (Fruit fruit : basket) {
            System.out.println(fruit); // ok
        }
//        basket.add(new Apple()); // ç¼–è¯‘é”™è¯¯

//       å­˜å…ƒç´ å¦‚æœç”¨fruits
        List<? extends Fruit> fruits = new ArrayList<>(); //
//        fruits.add(new Fruit()) // ç¼–è¯‘é”™è¯¯ï¼Œè®¤ä¸ºæ˜¯List<Fruit>ç±»å‹
//        fruits.add(new Apple()) // ç¼–è¯‘é”™è¯¯ï¼Œè®¤ä¸ºæ˜¯List<Apple>ç±»å‹
//        fruits.add(new Orange()) // ç¼–è¯‘é”™è¯¯ï¼Œè®¤ä¸ºæ˜¯List<Orange>ç±»å‹
//        List<Fruit>ï¼ŒList<Apple>ï¼ŒList<Orange>æ˜¯å®Œå…¨ä¸åŒçš„ç±»å‹ï¼Œç”¨? extends Fruitå­˜å…ƒç´ æ—¶ç¼–è¯‘å™¨å°±ä¸çŸ¥é“åˆ°åº•æ˜¯ä»€ä¹ˆç±»å‹ï¼Œç¼–è¯‘é”™è¯¯

        // å­˜å–å…ƒç´ ç”¨ ? super Fruitï¼Œfruitså½“æˆæ˜¯ç”Ÿäº§è€…,
        List<? super Fruit> fruits2 = new ArrayList<>();
        fruits2.add(new Fruit());
        fruits2.add(new Apple());
        fruits2.add(new Orange());

    }


    public static void getOutFruits2(List<? extends Fruit> basket) {
        for (Fruit fruit : basket) {
            System.out.println(fruit);
            //...do something other
        }
        System.out.println("--------------");
    }

    public static void getOutFruits(List<Fruit> basket) {
        for (Fruit fruit : basket) {
            System.out.println(fruit);
            //...do something other
        }
        System.out.println("--------------");
    }
}
```

1. å­˜

```
ç”¨äº†<? extends Fruit>ç›¸å½“äºå‘Šè¯‰ç¼–è¯‘å™¨ï¼Œæˆ‘ä»¬çš„ç¯®å­ï¼ˆé›†åˆï¼‰æ˜¯ç”¨æ¥å¤„ç†æ°´æœä»¥åŠæ°´æœçš„å­ç±»å‹ã€‚å› ä¸ºå­ç±»å‹æœ‰è®¸å¤šï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰å‘Šè¯‰ç¼–è¯‘å™¨æ˜¯å“ªä¸ªå­ç±»å‹ã€‚

ç¼–è¯‘å™¨åœ¨è¿™é‡Œé‡åˆ°çš„é—®é¢˜æ˜¯ï¼Œå¦‚æœaddçš„æ˜¯Appleç±»å‹æ—¶ï¼Œåˆ™basketåº”è¯¥æ˜¯List<Apple>ï¼Œå¦‚æœaddæ˜¯Fruitç±»å‹ï¼Œåˆ™basketåº”è¯¥æ˜¯List<Fruit>ã€‚è€ŒList<Apple>å’ŒList<Fruit>å‰é¢å·²ç»æè¿‡ï¼Œæ˜¯2ä¸ªå®Œå…¨æ²¡æœ‰å…³ç³»çš„ç±»å‹ï¼Œ
æ‰€ä»¥ç¼–è¯‘å™¨ä¸çŸ¥é“æ˜¯å“ªä¸ªå­ç±»å‹å°†åŠ å…¥é›†åˆï¼Œä¸çŸ¥é“åˆ°åº•æ˜¯List<Apple>è¿˜æ˜¯List<Fruit>ï¼Œæ‰€ä»¥ç¼–è¯‘å™¨åªèƒ½æŠ¥é”™ã€‚ï¼ˆæ³¨æ„ï¼Œè¿™é‡Œè®¨è®ºçš„éƒ½æ˜¯ç±»å‹ï¼Œè€Œä¸æ˜¯å¯¹è±¡ï¼‰

å¦ä¸€æ–¹é¢ï¼Œç¼–è¯‘å™¨å·²ç»çŸ¥é“é›†åˆé‡Œå…¨éƒ¨éƒ½æ˜¯æ°´æœçš„å­ç±»å‹ï¼Œæ‰€ä»¥ç¼–è¯‘å™¨å¯ä»¥ä¿è¯å–å‡ºçš„æ•°æ®å…¨éƒ¨æ˜¯æ°´æœã€‚
```

2. å–

```
ç”¨äº†<? super Apple>ç›¸å½“äºå‘Šè¯‰ç¼–è¯‘å™¨ï¼Œé›†åˆæ¥å—å¤„ç†Appleä»¥åŠAppleçš„è¶…ç±»å‹ï¼Œå³Objectï¼ŒFruitï¼ŒAppleä¸‰ä¸ªç±»å‹ã€‚
ä½†ç¼–è¯‘å™¨å¹¶ä¸çŸ¥é“åˆ°åº•æ˜¯List<Object>ï¼ŒList<Fruit>è¿˜æ˜¯List<Apple>ï¼Ÿ

ç¼–è¯‘å™¨åªçŸ¥é“ï¼Œè‹¹æœå’Œè‹¹æœå­ç±»å‹æ˜¯å¯ä»¥æ”¾è¿›å»ï¼ˆä¹Ÿæ˜¯Fruitçš„å­ç±»å‹ï¼Œä¹Ÿæ˜¯Objectçš„å­ç±»å‹ï¼‰ã€‚è¿™æ„å‘³ç€ï¼Œæˆ‘ä»¬æ€»æ˜¯å¯ä»¥å°†ä¸€ä¸ªè‹¹æœçš„å­ç±»å‹æ”¾å…¥è‹¹æœçš„è¶…ç±»å‹çš„listä¸­ã€‚

è€Œå–å‡ºæ—¶çš„æƒ…å†µæ˜¯ï¼Œç¼–è¯‘å™¨ä¸çŸ¥é“æ˜¯æŒ‰å“ªä¸ªç±»å‹å–å‡ºï¼Œ åˆ°åº•æ˜¯Objectï¼ŒFruitï¼ŒAppleä¸­çš„å“ªä¸ªå‘¢ï¼Ÿä½†æ˜¯ç¼–è¯‘å™¨å¯ä»¥é€‰æ‹©æ°¸è¿œä¸ä¼šé”™çš„ç±»å‹ï¼Œä¹Ÿå°±æ˜¯Objectçš„ç±»å‹ï¼Œå› ä¸ºObjectæ˜¯æ‰€æœ‰ç±»å‹çš„è¶…ç±»å‹ã€‚
```

## Ref

- [x] - Kotlin çš„æ³›å‹ <https://kaixue.io/kotlin-generics/>

> è®²è§£çš„å¾ˆä¸é”™

- [x] java æ³›å‹ï¼ˆäºŒï¼‰ã€æ³›å‹çš„å†…éƒ¨åŸç†ï¼šç±»å‹æ“¦é™¤ä»¥åŠç±»å‹æ“¦é™¤å¸¦æ¥çš„é—®é¢˜<br><https://blog.csdn.net/lonelyroamer/article/details/7868820>#>
- [x] ä½ åº”è¯¥çŸ¥é“çš„æ³›å‹ (Generic) ä¸ PECS åŸåˆ™<br><https://www.jianshu.com/p/e5b8cd33ec94>
