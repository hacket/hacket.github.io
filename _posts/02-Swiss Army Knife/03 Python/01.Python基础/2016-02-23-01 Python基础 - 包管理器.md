---
banner:
date_created: Friday, February 23rd 2016, 10:10:45 pm
date_updated: Friday, November 14th 2025, 8:29:18 am
title: 01 Python基础 - 包管理器
author: hacket
categories:
  - Python
category: Python基础
tags: [Python]
toc: true
description: 
dg-publish: true
dg-enable-search: true
dg-show-local-graph: true
dg-show-toc: true
dg-show-file-tree: true
date created: Thursday, March 7th 2024, 8:17:00 pm
date updated: Saturday, January 4th 2025, 7:13:38 pm
image-auto-upload: true
feed: show
format: list
aliases: [Python 基础 - 包管理器]
linter-yaml-title-alias: Python 基础 - 包管理器
---

# Python 基础 - 包管理器

## pip

在 Python 中，安装第三方模块，是通过包管理工具 `pip` 完成的。

- Mac 和 Linux 自带 pip 工具
- Windows 需要安装 pip

### 设置镜像源

`pip install pip-setting`

输入 pip-setting, 选择阿里源

清华源：`pip install -i https://pypi.tuna.tsinghua.edu.cn/simple +模块名`

### 安装三方库

`pip install xxx`

## Python 虚拟环境是什么？

Python 虚拟环境 (Virtual Environment) 就是为每个项目创建一个独立的一套完整的工具（Python 解释器和包安装工具）。

### 为什么需要虚拟环境？

在使用 Python 语言时，通过 pip（pip3）来安装第三方包，但是由于 pip 的特性，系统中只能安装每个包的一个版本。但是在实际项目开发中，不同项目可能需要第三方包的不同版本，迫使我们需要根据实际需求不断进行更新或卸载相应的包，而如果我们直接使用本地的 Python 环境，会导致整体的开发环境相当混乱而不易管理，这时候我们就需要开辟一个独立干净的空间进行开发和部署，虚拟环境就孕育而生。

以 Pycham 创建新项目时候环境选择的环境为切入点，如下所示：

![image.png](https://raw.githubusercontent.com/hacket/ObsidianOSS/master/obsidian/202511140815684.png)

### 虚拟环境解决了什么核心问题？

1. **依赖隔离 (Dependency Isolation)**：这是最核心的问题。它防止了不同项目之间因依赖库的版本不同而产生的冲突。
2. **环境复现 (Reproducible Environments)**：你可以将项目所用的所有库及其精确版本号记录在一个文件里（通常是 `requirements.txt`）。当你的同事或者部署服务器需要运行这个项目时，他们可以根据这个 " 书单 " 在自己的虚拟环境中快速、准确地创建出一个一模一样的环境，确保代码在任何地方都能以同样的方式运行。
3. **保持全局环境整洁 (Clean Global Environment)**：避免将所有包都安装到系统级的 Python 环境中。这不仅容易造成混乱和冲突，还可能影响到操作系统依赖的 Python 工具。虚拟环境让你的全局环境保持最小和最干净的状态。
4. **权限问题**：在某些系统中，你可能没有权限向全局 Python 环境中安装包。虚拟环境创建在你的用户目录下，你拥有完全的读写权限。

### Python 创建虚拟环境的三种方式

#### Virtualenv

Virtualenv 是目前最流行的 Python 虚拟环境配置工具，同时支持 Python2 和 Python3，也可以为每个虚拟环境指定 Python 解释器。

安装 pip 后，可使用以下命令安装 Virtualenv：

```shell
pip3 install virtualenv
```

搭建一个虚拟环境:

```shell
virtualenv venv
```

如果存在多个 python 解释器，可以选择指定一个 Python 解释器（比如 python3.6），没有指定则由系统默认的解释器来搭建（变更默认的 python 版本可以看看 {% post_link Python/使用 update-alternatives 管理多个版本的 Python %})：

```shell
virtualenv -p /usr/bin/python3.6 venv
```

将会在当前的目录中创建一个名 `venv` 的文件夹，这是一个独立的 python 运行环境，包含了 Python 可执行文件，以及 pip 库的一份拷贝，但第三方包需要重新安装。

要开始使用虚拟环境，其需要被激活：

```shell
source venv/bin/activate
```

停用虚拟环境：

```shell
deactivate
```

virtualenv 的一个最大的缺点就是，**每次开启虚拟环境之前要去虚拟环境所在目录下的 bin 目录下 source 一下 activate**。这时候 `virtualenvwrapper` 出现了，**它对不同的虚拟环境使用不同的目录进行管理，并且还省去了每次开启虚拟环境时候的 source 操作**，使得虚拟环境更加好用。

```shell
pip3 install virtualenvwrapper
```

`vim ~/.bashrc开始配置virtualenvwrapper`:

```shell
export WORKON_HOME=$HOME/.virtualenvs
source /usr/local/bin/virtualenvwrapper.sh
```

接着执行 `source ~/.bashrc`(或 `./zshrc`)。

#### venv ：最朴素的环境隔离方式

Python 自带的 venv，其实已经能满足不少轻量项目的需求，特别是写脚本、做简单工具的时候，它就足够用了。

```shell
# 创建虚拟环境
python -m venv venv
# 激活环境（Linux / macOS）
source venv/bin/activate
# Windows：
venv\Scripts\activate
# 退出环境
deactivate
```

它的优点是：

- python 自带，非常轻量
同时这也是它的缺点：
- 依赖于某个 python 版本。
- 当你的工程不支持这个版本时，就又要一番折腾

#### Pipenv

pipenv 是 Pipfile 主要倡导者、requests 作者 Kenneth Reitz 写的一个命令行工具，主要包含了 `Pipfile`、`pip`、`click`、`requests` 和 `virtualenv`，能够有效管理 Python 多个环境，各种第三方包及模块。

pipenv 所解决的问题:

- requirements.txt 依赖管理的局限
- 多个项目依赖不同第三方库、包版本问题
- 依赖分析
pipenv 的特性：
- pipenv 集成了 pip，virtualenv 两者的功能，且完善了两者的一些缺陷。
- 过去用 virtualenv 管理 requirements.txt 文件可能会有问题，Pipenv 使用 Pipfile 和 Pipfile.lock，后者存放将包的依赖关系，查看依赖关系是十分方便。
- 各个地方使用了哈希校验，无论安装还是卸载包都十分安全，且会自动公开安全漏洞。
- 通过加载.env 文件简化开发工作流程。
- 支持 Python2 和 Python3，在各个平台的命令都是一样的。

`pip是用于安装和管理软件包的包管理器。`

#### conda

Anaconda（官方网站）就是可以便捷获取包且对包能够进行管理，同时对环境可以统一管理的发行版本。Anaconda 包含了 conda、Python 在内的超过 180 个科学包及其依赖项。Anaconda 也有自己的虚拟环境系统，称为 conda。conda 包和环境管理器包含于 Anaconda 的所有版本当中。

## uv

### uv 是什么？

知名工具 Ruff 的开发者 Astral 公司打造的一款**极其快速的 Python 包和项目管理器**。它旨在成为 `pip`, `pip-tools`, `virtualenv` 等传统工具的现代化、高性能替代品。

`uv` 是一个用 Rust 编写的命令行工具，它的出现旨在解决 Python 开发中长期存在的依赖管理和虚拟环境创建速度慢的问题。

### uv 主要特点和优势

- **⚡️ 惊人的速度**：`uv` 的核心优势是其无与伦比的速度。无论是在安装、更新还是解析依赖时，`uv` 的速度通常比 `pip` 快 10 到 100 倍。这主要得益于其底层的 Rust 实现以及先进的依赖解析算法和高效的缓存机制。
	
- **一体化工具链**：`uv` 整合了多个传统工具的功能于一身，您可以只用一个 `uv` 命令就完成：
	- **包管理** (`pip` 的替代品): `uv pip install <package>`
	- **虚拟环境管理** (`venv`/`virtualenv` 的替代品): `uv venv`
	- **依赖锁定** (`pip-tools` 的替代品): `uv pip compile`
		
- **即插即用**：`uv` 被设计为 `pip` 和 `pip-tools` 的直接替代品，它兼容 `requirements.txt` 文件，使得在现有项目中迁移和使用变得非常简单。
	
- **Rust 驱动的性能和可靠性**：由于使用 Rust 语言编写，`uv` 不仅速度快，还保证了内存安全和高并发处理能力。
	
- **跨平台支持**：`uv` 完美支持 Windows, MacOS, 和 Linux。

### 安装 uv

- pip

```shell
pip install uv
```

- 脚本 **(推荐，无需预装 Python)**

```shell
# Mac/Linux
curl -LsSf https://astral.sh/uv/install.sh | sh

# Windows
powershell -c "irm https://astral.sh/uv/install.ps1 | iex"
```

### uv 使用

#### 创建虚拟环境

速度远超 `python -m venv`

```shell
uv venv
```

这会在当前目录下创建一个名为 `.venv` 的虚拟环境。

#### 激活虚拟环境 (与标准方式相同)

```shell
# Mac/Linux
source .venv/bin/activate

# Windows
.venv\Scripts\activate
```

#### 安装包

```shell
uv pip install requests "fastapi[all]"
```

#### 从 requirements.txt 安装依赖

```shell
uv pip install -r requirements.txt
```

#### 生成 requirements.lock 文件 (锁定依赖版本)

```shell
uv pip compile requirements.in -o requirements.lock
```

## uv 和 pip 区别

| 特性 / 方面    | `pip` (及其生态工具)                                                       | `uv`                                                       |
| ---------- | -------------------------------------------------------------------- | ---------------------------------------------------------- |
| **核心定位**   | 分散的工具集 (专注于一件事)                                                      | 一体化的解决方案 (All-in-One)                                      |
| **主要功能**   | **包安装器**。需配合 `venv` 创建环境，`pip-tools` 锁定依赖。                           | 集包安装、虚拟环境管理、依赖锁定于一身的综合工具。                                  |
| **性能速度**   | **标准**。纯 Python 实现，在解析复杂依赖时可能较慢。                                     | **极快** (通常快 10-100 倍)。由 Rust 编写，为性能和并行而生。                  |
| **虚拟环境管理** | **外部依赖**。使用 `python -m venv` 命令创建，速度一般。                              | **内置且高速**。使用 `uv venv` 命令，创建速度远超原生 `venv`。                 |
| **依赖锁定**   | **外部依赖**。需要 `pip-tools` (`pip-compile`) 等额外工具。                       | **内置功能**。提供 `uv pip compile` 命令，速度极快。                      |
| **缓存机制**   | 有包缓存，但设计较为传统。                                                        | 更现代、高效的全局缓存，能更好地跨项目共享。                                     |
| **底层实现语言** | Python                                                               | Rust                                                       |
| **开发者/来源** | PyPA (Python 官方打包机构) / 社区驱动                                          | Astral (知名工具 Ruff 的开发者)                                    |
| **兼容性**    | 作为行业标准，是所有工具兼容的基础。                                                   | **直接替代品**。完全兼容 `requirements.txt` 等 `pip` 的生态。             |
| **典型工作流**  | 1. `python -m venv .venv` <br> 2. `activate` <br> 3. `pip install …` | 1. `uv venv` <br> 2. `activate` <br> 3. `uv pip install …` |
| **简而言之**   | **可靠、标准的 " 工具箱 "**，包含多个独立的经典工具。                                         | **一个高速、现代的 " 多功能电动工具 "**，集成了所有常用功能。                           |

uv 和 pip 在虚拟环境区别：

- **`pip` 的工作流 (分散式)**:
	1. `python -m venv .venv` _(使用一个工具创建环境)_
	2. `source .venv/bin/activate` _(激活环境)_
	3. `pip install requests` _(使用另一个工具安装包)_

- **`uv` 的工作流 (集成式)**:
	1. `uv venv` _(使用 uv 创建环境)_
	2. `source .venv/bin/activate` _(激活环境，此步骤仍是标准操作)_
	3. `uv pip install requests` _(使用 uv 安装包)_
