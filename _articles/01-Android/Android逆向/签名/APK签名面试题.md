---
date created: 2024-12-24 00:40
date updated: 2024-12-24 00:40
dg-publish: true
---

# 面试题

## APK组成？和AAB的区别？

## Android中的签名证书和普通的证书区别？

Anroid中的签名证书不需要权威机构认证，一般是开发者的自签名证书

## keystore除了要指定keystore文件和密码外，也要指定alias和key的密码，这是为什么呢？

keystore是一个**密钥库**，也就是说它可以**存储多对密钥和证书**，keystore的密码` storePassword  `是用于保护keystore本身的，一对密钥和证书是通过alias来区分的。从这里可以看出jarsigner是支持使用多个证书对Apk进行签名的。apksigner也同样支持，关于apksigner的使用介绍可以参考官方文档apksigner。

## 签名校验的机制是什么？具体校验的是什么内容吗？

APK签名是为了保证APK的完整性和来源的真实性，分为JAR签名和V2签名（目前还有v3、v4）方案。核心思想均是计算APK内容的hash，再使用签名算法对hash进行签名。校验时通过签名者公钥解密签名，再与校验者计算的APK内容hash进行比对，一致则校验通过。

## 申请第三方SDK（如微信支付）时填入的SAH1值是什么？

签名证书的指纹，在申请第三方SDK时，需填入APK包名和证书指纹，SDK开发者后台会根据这两个值生成一个key。第三方SDK在初始化时，会从系统中获取当前APK的包名、签名证书指纹以及key，然后将此指纹上传到其服务器，然后校验包名、签名证书指纹是否与此key绑定，校验通过后才进行授权。

## 目前众多的快速批量打包方案又是如何绕过签名检验的？

**V1签名的渠道包方案：**

1. 反编译APK后修改渠道值，再重新打包这种方案实际上是重新签名，因有反编译、重新打包、签名的过程，速度相对后两种方案较慢；
2. 将渠道信息以文件形式写入META-INF目录中因为META-INF目录是用来存放签名的，其本身无法加入签名校验中，在META-INF目录中添加文件不会破坏原有签名。此方案需同时修改zip数据区、中央目录和中央目录结尾记录；
3. 将渠道信息写到zip中央目录结尾记录的comment字段中

> 通过分析zip文件结构，可以发现中央目录结尾记录最后注释字段，这部分内容在JAR签名方案中同样不在签名校验范围中，故添加注释也不会破坏原有签名。此方案只需修改中央目录结尾记录；

4. productFlavor？

**V2签名的渠道方案：**<br />APK签名分块中有一个ID-VALUE序列， 签名信息（APK 签名方案 v2 分块）只存储在ID 为 0x7109871a的ID-VALUE中，通过分析签名校验源码可以发现，其它ID-VALUE数据是未被解析的，也就是说除APK 签名方案 v2 分块外，其余ID-VALUE是不影响签名校验的。<br />故可以**定义一个新的ID-VALUE**，将渠道信息写入APK签名分块中。因为V2方案只保证了第1、3、4部分和第 2 部分（APK签名分块）包含的APK 签名方案 v2分块中的 signed data 分块的完整性。新写入的ID-VALUE不受保护，Walle就是这种方案。
